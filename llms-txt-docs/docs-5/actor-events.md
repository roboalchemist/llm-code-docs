# Source: https://docs.apify.com/sdk/python/docs/concepts/actor-events.md

# Actor events & state persistence

Copy for LLM

During its runtime, the Actor receives Actor events sent by the Apify platform or generated by the Apify SDK itself.

## Event types[](#event-types)

| Event           | Data                                                                                                         | Description                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| --------------- | ------------------------------------------------------------------------------------------------------------ | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| `SYSTEM_INFO`   | ```
{
"created_at": datetime,
"cpu_current_usage": float,
"mem_current_bytes": int,
"is_cpu_overloaded": bool
}
``` | This event is emitted regularly and it indicates the current resource usage of the Actor.The `is_cpu_overloaded` argument indicates whether the current CPU usage is higher than `Config.max_used_cpu_ratio`                                                                                                                                                                                                                                                                                                                                                                                                            |
| `MIGRATING`     | `None`                                                                                                       | Emitted when the Actor running on the Apify platform is going to be [migrated](https://docs.apify.com/platform/actors/development/state-persistence#what-is-a-migration) <!-- --><!-- -->to another worker server soon.You can use it to persist the state of the Actor so that once it is executed again on the new server, it doesn't have to start over from the beginning. Once you have persisted the state of your Actor, you can call [`Actor.reboot`](https://docs.apify.com/sdk/python/../../reference/class/Actor#reboot) to reboot the Actor and trigger the migration immediately, to speed up the process. |
| `ABORTING`      | `None`                                                                                                       | When a user aborts an Actor run on the Apify platform, they can choose to abort gracefully to allow the Actor some time before getting killed. This graceful abort emits the `ABORTING` event which you can use to finish all running tasks and do cleanup.                                                                                                                                                                                                                                                                                                                                                             |
| `PERSIST_STATE` | ```
{ "is_migrating": bool }
```                                                                               | Emitted in regular intervals (by default 60 seconds) to notify the Actor that it should persist its state, in order to avoid repeating all work when the Actor restarts.This event is also emitted automatically when the `MIGRATING` event happens, in which case the `is_migrating` flag is set to `True`.Note that the `PERSIST_STATE` event is provided merely for user convenience, you can achieve the same effect by persisting the state regularly in an interval and listening for the migrating event.                                                                                                        |

## Adding handlers to events[](#adding-handlers-to-events)

To add handlers to these events, you use the [`Actor.on`](https://docs.apify.com/sdk/python/sdk/python/reference/class/Actor.md#on) method, and to remove them, you use the [`Actor.off`](https://docs.apify.com/sdk/python/sdk/python/reference/class/Actor.md#off) method.

[Run on](https://console.apify.com/actors/HH9rhkFXiZbheuq1V?runConfig=eyJ1IjoiRWdQdHczb2VqNlRhRHQ1cW4iLCJ2IjoxfQ.eyJpbnB1dCI6IntcImNvZGVcIjpcImltcG9ydCBhc3luY2lvXFxuZnJvbSB0eXBpbmcgaW1wb3J0IEFueVxcblxcbmZyb20gYXBpZnkgaW1wb3J0IEFjdG9yLCBFdmVudFxcblxcblxcbmFzeW5jIGRlZiBtYWluKCkgLT4gTm9uZTpcXG4gICAgYXN5bmMgd2l0aCBBY3RvcjpcXG4gICAgICAgIHRvdGFsX2l0ZW1zID0gMTAwMFxcblxcbiAgICAgICAgIyBMb2FkIHRoZSBzdGF0ZSBpZiBpdCdzIHNhdmVkIGZyb20gc29tZSBwcmV2aW91cyBleGVjdXRpb25cXG4gICAgICAgIHByb2Nlc3NlZF9pdGVtcyA9IDBcXG4gICAgICAgIGFjdG9yX3N0YXRlID0gYXdhaXQgQWN0b3IuZ2V0X3ZhbHVlKCdTVEFURScpXFxuICAgICAgICBpZiBhY3Rvcl9zdGF0ZSBpcyBub3QgTm9uZTpcXG4gICAgICAgICAgICBwcm9jZXNzZWRfaXRlbXMgPSBhY3Rvcl9zdGF0ZVxcblxcbiAgICAgICAgIyBTYXZlIHRoZSBzdGF0ZSB3aGVuIHRoZSBgUEVSU0lTVF9TVEFURWAgZXZlbnQgaGFwcGVuc1xcbiAgICAgICAgYXN5bmMgZGVmIHNhdmVfc3RhdGUoZXZlbnRfZGF0YTogQW55KSAtPiBOb25lOlxcbiAgICAgICAgICAgIG5vbmxvY2FsIHByb2Nlc3NlZF9pdGVtc1xcbiAgICAgICAgICAgIEFjdG9yLmxvZy5pbmZvKCdTYXZpbmcgQWN0b3Igc3RhdGUnLCBleHRyYT1ldmVudF9kYXRhKVxcbiAgICAgICAgICAgIGF3YWl0IEFjdG9yLnNldF92YWx1ZSgnU1RBVEUnLCBwcm9jZXNzZWRfaXRlbXMpXFxuXFxuICAgICAgICBBY3Rvci5vbihFdmVudC5QRVJTSVNUX1NUQVRFLCBzYXZlX3N0YXRlKVxcblxcbiAgICAgICAgIyBEbyBzb21lIGZha2Ugd29ya1xcbiAgICAgICAgZm9yIGkgaW4gcmFuZ2UocHJvY2Vzc2VkX2l0ZW1zLCB0b3RhbF9pdGVtcyk6XFxuICAgICAgICAgICAgQWN0b3IubG9nLmluZm8oZidQcm9jZXNzaW5nIGl0ZW0ge2l9Li4uJylcXG4gICAgICAgICAgICBwcm9jZXNzZWRfaXRlbXMgPSBpXFxuICAgICAgICAgICAgYXdhaXQgYXN5bmNpby5zbGVlcCgwLjEpXFxuXFxuICAgICAgICAjIFN1cHBvc2Ugd2UgY2FuIHN0b3Agc2F2aW5nIHRoZSBzdGF0ZSBub3dcXG4gICAgICAgIEFjdG9yLm9mZihFdmVudC5QRVJTSVNUX1NUQVRFLCBzYXZlX3N0YXRlKVxcblxcbiAgICAgICAgIyBEbyBzb21lIG1vcmUgZmFrZSB3b3JrLCB0aGlzIHRpbWUgc29tZXRoaW5nIHRoYXQgY2FuJ3QgYmUgcmVzdGFydGVkLFxcbiAgICAgICAgIyBzbyBubyBwb2ludCBwZXJzaXN0aW5nIHRoZSBzdGF0ZVxcbiAgICAgICAgZm9yIGogaW4gcmFuZ2UoMTApOlxcbiAgICAgICAgICAgIEFjdG9yLmxvZy5pbmZvKGYnUHJvY2Vzc2luZyBpdGVtIHtqfSBvZiBhbm90aGVyIGtpbmQuLi4nKVxcbiAgICAgICAgICAgIGF3YWl0IGFzeW5jaW8uc2xlZXAoMSlcXG5cXG5cXG5pZiBfX25hbWVfXyA9PSAnX19tYWluX18nOlxcbiAgICBhc3luY2lvLnJ1bihtYWluKCkpXFxuXCJ9Iiwib3B0aW9ucyI6eyJidWlsZCI6ImxhdGVzdCIsImNvbnRlbnRUeXBlIjoiYXBwbGljYXRpb24vanNvbjsgY2hhcnNldD11dGYtOCIsIm1lbW9yeSI6MTAyNCwidGltZW91dCI6MTgwfX0.MtXEA1LZvr-mLxWodlPvIvq4ZZKoHen0AbDsC3S7Ayo\&asrc=run_on_apify)

```
import asyncio
from typing import Any

from apify import Actor, Event


async def main() -> None:
    async with Actor:
        total_items = 1000

        # Load the state if it's saved from some previous execution
        processed_items = 0
        actor_state = await Actor.get_value('STATE')
        if actor_state is not None:
            processed_items = actor_state

        # Save the state when the `PERSIST_STATE` event happens
        async def save_state(event_data: Any) -> None:
            nonlocal processed_items
            Actor.log.info('Saving Actor state', extra=event_data)
            await Actor.set_value('STATE', processed_items)

        Actor.on(Event.PERSIST_STATE, save_state)

        # Do some fake work
        for i in range(processed_items, total_items):
            Actor.log.info(f'Processing item {i}...')
            processed_items = i
            await asyncio.sleep(0.1)

        # Suppose we can stop saving the state now
        Actor.off(Event.PERSIST_STATE, save_state)

        # Do some more fake work, this time something that can't be restarted,
        # so no point persisting the state
        for j in range(10):
            Actor.log.info(f'Processing item {j} of another kind...')
            await asyncio.sleep(1)


if __name__ == '__main__':
    asyncio.run(main())
```
