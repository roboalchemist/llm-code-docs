# Source: https://dev.writer.com/blueprints/setstate.md

# Set state

Stores a value in the Agent's state. Use to remember data across steps.

<img src="https://mintcdn.com/writer/KruNpIclsgQbhj82/images/agent-builder/blueprints/set-state-block.png?fit=max&auto=format&n=KruNpIclsgQbhj82&q=85&s=ca95ff0a9947fdd1aaa4e6f01516c8b1" alt="" data-og-width="2188" width="2188" data-og-height="1436" height="1436" data-path="images/agent-builder/blueprints/set-state-block.png" data-optimize="true" data-opv="3" srcset="https://mintcdn.com/writer/KruNpIclsgQbhj82/images/agent-builder/blueprints/set-state-block.png?w=280&fit=max&auto=format&n=KruNpIclsgQbhj82&q=85&s=bf52785c8e44056875c61cc2f6717ec0 280w, https://mintcdn.com/writer/KruNpIclsgQbhj82/images/agent-builder/blueprints/set-state-block.png?w=560&fit=max&auto=format&n=KruNpIclsgQbhj82&q=85&s=9046daa2f7607f475335f077f9c50307 560w, https://mintcdn.com/writer/KruNpIclsgQbhj82/images/agent-builder/blueprints/set-state-block.png?w=840&fit=max&auto=format&n=KruNpIclsgQbhj82&q=85&s=9c9edd4e44606e760167ef411367f14c 840w, https://mintcdn.com/writer/KruNpIclsgQbhj82/images/agent-builder/blueprints/set-state-block.png?w=1100&fit=max&auto=format&n=KruNpIclsgQbhj82&q=85&s=42d11c5c60cfcd581767226d4359a632 1100w, https://mintcdn.com/writer/KruNpIclsgQbhj82/images/agent-builder/blueprints/set-state-block.png?w=1650&fit=max&auto=format&n=KruNpIclsgQbhj82&q=85&s=5175f7c343f861e14d7e16136435d2ce 1650w, https://mintcdn.com/writer/KruNpIclsgQbhj82/images/agent-builder/blueprints/set-state-block.png?w=2500&fit=max&auto=format&n=KruNpIclsgQbhj82&q=85&s=22c1239dd38b41d32e6c132eae96b94a 2500w" />

## Overview

The **Set state** block is a core building block that connects information between different parts of your blueprint, interface, and code. It acts as a bridge, allowing data to flow from one part of your workflow to another - whether that's from blueprint to interface, between different blueprint blocks, from interface back to blueprint, or to and from custom Python code.

You can specify the variable name, value, and value type (plain text or JSON). The value is then available in subsequent blocks via the state variable.

## Common use cases

* Storing user input or intermediate results
* Passing data between blocks in a workflow
* Saving API responses or generated content for later use
* Managing workflow state or flags
* Storing block results to display in interface components
* Persisting data between interface updates and refreshes

## How it works

1. **Link Variable**: Specify the name of the state variable to set.
2. **Value type**: Choose whether the value is plain text or JSON. The default if not specified is plain text.
3. **Value**: Enter the value to store.

The block saves the value in the specified state variable. You can reference this variable in later blocks using the state syntax, for example, `@{state.variable_name}`.

## Examples

### Text generation workflow

This example shows how to generate text and display it in the interface using state management.

**Blueprint Flow:**

1. **UI Trigger** → User clicks "Generate" button
2. **Text generation** → Creates content based on prompt
3. **Set state** → Stores generated text

**Interface** → Has a **Text** component that displays the text from the state variable

**Block Configuration:**

* **Link Variable:** `generated_text`
* **Value type**: `text`. The default if not specified is plain text.
* **Value:** `@{result}`. This variable is the text generated by the text generation block that precedes the **Set state** block.

<img src="https://mintcdn.com/writer/KruNpIclsgQbhj82/images/agent-builder/blueprints/set-state-workflow.png?fit=max&auto=format&n=KruNpIclsgQbhj82&q=85&s=add566046e86daebbb53699f0b8977f6" alt="" data-og-width="2430" width="2430" data-og-height="1568" height="1568" data-path="images/agent-builder/blueprints/set-state-workflow.png" data-optimize="true" data-opv="3" srcset="https://mintcdn.com/writer/KruNpIclsgQbhj82/images/agent-builder/blueprints/set-state-workflow.png?w=280&fit=max&auto=format&n=KruNpIclsgQbhj82&q=85&s=de782f27118ab00e37db243efc8befcc 280w, https://mintcdn.com/writer/KruNpIclsgQbhj82/images/agent-builder/blueprints/set-state-workflow.png?w=560&fit=max&auto=format&n=KruNpIclsgQbhj82&q=85&s=4468babdd375012080327542a42f6608 560w, https://mintcdn.com/writer/KruNpIclsgQbhj82/images/agent-builder/blueprints/set-state-workflow.png?w=840&fit=max&auto=format&n=KruNpIclsgQbhj82&q=85&s=a6fa8f0194efb769e712d38819cad9a6 840w, https://mintcdn.com/writer/KruNpIclsgQbhj82/images/agent-builder/blueprints/set-state-workflow.png?w=1100&fit=max&auto=format&n=KruNpIclsgQbhj82&q=85&s=40184967b3393fd1f07e7d1b198a3c7b 1100w, https://mintcdn.com/writer/KruNpIclsgQbhj82/images/agent-builder/blueprints/set-state-workflow.png?w=1650&fit=max&auto=format&n=KruNpIclsgQbhj82&q=85&s=6fa66d1f80e939aa75f6b837f15567e8 1650w, https://mintcdn.com/writer/KruNpIclsgQbhj82/images/agent-builder/blueprints/set-state-workflow.png?w=2500&fit=max&auto=format&n=KruNpIclsgQbhj82&q=85&s=6d84a91671d1d11cc5443b95a8880850 2500w" />

This workflow enables automated text generation and display in the interface.

### Form submission workflow with JSON value type

This example shows how to package multiple form field responses into a single state variable. It's useful when collecting and storing related data from interface forms.

**Blueprint Flow:**

1. **UI Trigger** → User submits a registration form. All the form fields have Link Variables set to the name of the field.
2. **Set state** → Stores all form fields as JSON

**Block Configuration:**

* **Link Variable:** `form_data`
* **Value type**: `JSON`
* **Value:**
  ```json  theme={null}
  {
    "firstName": @{firstName},
    "lastName": @{lastName},
    "email": @{email},
    "phoneNumber": @{phoneNumber},
    "address": {
      "street": @{address.street},
      "city": @{address.city},
      "state": @{address.state},
      "zipCode": @{address.zipCode}
    },
    "preferences": {
      "newsletter": @{preferences.newsletter},
      "notifications": @{preferences.notifications}
    }
  }
  ```

<img src="https://mintcdn.com/writer/KruNpIclsgQbhj82/images/agent-builder/blueprints/set-state-json.png?fit=max&auto=format&n=KruNpIclsgQbhj82&q=85&s=ac4f9e3eed6342875e6eb547d744969b" alt="" data-og-width="2070" width="2070" data-og-height="1378" height="1378" data-path="images/agent-builder/blueprints/set-state-json.png" data-optimize="true" data-opv="3" srcset="https://mintcdn.com/writer/KruNpIclsgQbhj82/images/agent-builder/blueprints/set-state-json.png?w=280&fit=max&auto=format&n=KruNpIclsgQbhj82&q=85&s=9936661dbfd9b1ac698189e1af738ab7 280w, https://mintcdn.com/writer/KruNpIclsgQbhj82/images/agent-builder/blueprints/set-state-json.png?w=560&fit=max&auto=format&n=KruNpIclsgQbhj82&q=85&s=b0a706cfd879eb904b8acc71e56f748e 560w, https://mintcdn.com/writer/KruNpIclsgQbhj82/images/agent-builder/blueprints/set-state-json.png?w=840&fit=max&auto=format&n=KruNpIclsgQbhj82&q=85&s=4a548fc6088c62859e65a50e0785b169 840w, https://mintcdn.com/writer/KruNpIclsgQbhj82/images/agent-builder/blueprints/set-state-json.png?w=1100&fit=max&auto=format&n=KruNpIclsgQbhj82&q=85&s=e8b4a25489a30e70e4f271f382bbcdaa 1100w, https://mintcdn.com/writer/KruNpIclsgQbhj82/images/agent-builder/blueprints/set-state-json.png?w=1650&fit=max&auto=format&n=KruNpIclsgQbhj82&q=85&s=1251dacb8a47e74d6ce016bc4db5b45e 1650w, https://mintcdn.com/writer/KruNpIclsgQbhj82/images/agent-builder/blueprints/set-state-json.png?w=2500&fit=max&auto=format&n=KruNpIclsgQbhj82&q=85&s=2bb746c714539b9ddb44ebe2cc037ce1 2500w" />

To access specific fields of the JSON data, use the state syntax, for example `@{form_data.firstName}` or `@{form_data.address.city}`.

<Tip>
  To access elements of the state variable using Python, treat it as a dictionary. For example, `@{state["form_data"]["firstName"]}` or `@{state["form_data"]["address"]["city"]}`.
</Tip>

## Fields

<table className="blueprintFields">
  <thead>
    <th>Name</th>
    <th>Type</th>
    <th>Control</th>
    <th>Default</th>
    <th>Description</th>
    <th>Options</th>
    <th>Validation</th>
  </thead>

  <tbody>
    <tr>
      <td>Link Variable</td>
      <td>Binding</td>
      <td>-</td>

      <td>
        <span>-</span>
      </td>

      <td>Set the variable here and use it across your agent</td>

      <td>
        <span>-</span>
      </td>

      <td>
        <span>-</span>
      </td>
    </tr>

    <tr>
      <td>Value type</td>
      <td>Text</td>
      <td>-</td>

      <td>
        <code>text</code>
      </td>

      <td>-</td>

      <td>
        <ul>
          <li>text - Plain text</li>

          <li>JSON - JSON</li>
        </ul>
      </td>

      <td>
        <span>-</span>
      </td>
    </tr>

    <tr>
      <td>Value</td>
      <td>Text</td>
      <td>Textarea</td>

      <td>
        <span>-</span>
      </td>

      <td>-</td>

      <td>
        <span>-</span>
      </td>

      <td>
        <span>-</span>
      </td>
    </tr>
  </tbody>
</table>

## End states

Below are the possible end states of the block call.

<table className="blueprintFields">
  <thead>
    <th>Name</th>
    <th>Field</th>
    <th>Type</th>
    <th>Description</th>
  </thead>

  <tbody>
    <tr>
      <td>Success</td>
      <td>-</td>
      <td>success</td>
      <td>If the function doesn't raise an Exception.</td>
    </tr>

    <tr>
      <td>Error</td>
      <td>-</td>
      <td>error</td>
      <td>If the function raises an Exception.</td>
    </tr>
  </tbody>
</table>

The **Set state** block returns the value that was set in the state variable. You can access this value in the following block as `@{result}`, or you can use the state syntax to access the value in the state variable, for example `@{form_data}`.
