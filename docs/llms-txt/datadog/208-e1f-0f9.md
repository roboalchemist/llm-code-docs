# Source: https://docs.datadoghq.com/security/default_rules/208-e1f-0f9.md

---
title: AWS console login without MFA
description: Datadog, the leading service for cloud-scale monitoring.
breadcrumbs: Docs > Datadog Security > OOTB Rules > AWS console login without MFA
---

# AWS console login without MFA
Classification:attackTactic:[TA0001-initial-access](https://attack.mitre.org/tactics/TA0001)Technique:[T1078-valid-accounts](https://attack.mitre.org/techniques/T1078)
## Goal{% #goal %}

Detect when any user logs in to your AWS console without multi-factor authentication.

## Strategy{% #strategy %}

This rule monitors CloudTrail and detects when any `IAMUser` or `Root` user does a `Console Login`, and `@userIdentity.sessionContext.attributes.mfaAuthenticated` has a value of `false`.

**Notes:**

- This rule triggers with a `High` severity if the user logging in is a `Root` user.
- This rule ignores logins using SAML because 2FA is implemented on the IdP and not through AWS.

## Triage and response{% #triage-and-response %}

1. Reach out to the {{@usr.name}} to determine if the login was legitimate.
   - Use Cloud SIEM - User Investigation dashboard to see if the user: {{@usr.name}} with an account type of: {{@userIdentity.type}} has done any actions after logging in.
1. If the login was legitimate, request that the user enables 2FA.
1. If the login wasn't legitimate, rotate the credentials, enable 2FA and triage an actions uncovered from step 1.
1. Review all user accounts to ensure MFA is enabled.

## Changelog{% #changelog %}

3 March 2022 - Updated rule.
