# Source: https://docs.datadoghq.com/security/default_rules/def-000-b54.md

---
title: Set Existing Passwords Maximum Age
description: Datadog, the leading service for cloud-scale monitoring.
breadcrumbs: Docs > Datadog Security > OOTB Rules > Set Existing Passwords Maximum Age
---

# Set Existing Passwords Maximum Age

## Description{% #description %}

Configure non-compliant accounts to enforce a 365-day maximum password lifetime restriction by running the following command:

```
$ sudo chage -M 365
          USER

```

## Rationale{% #rationale %}

Any password, no matter how complex, can eventually be cracked. Therefore, passwords need to be changed periodically. If the operating system does not limit the lifetime of passwords and force users to change their passwords, there is the risk that the operating system passwords could be compromised.

## Remediation{% #remediation %}

### Shell script{% #shell-script %}

The following script can be run on the host to remediate the issue.

```bash
#!/bin/bash

var_accounts_maximum_age_login_defs='365'


while IFS= read -r i; do

    chage -M $var_accounts_maximum_age_login_defs $i

done <   <(awk -v var="$var_accounts_maximum_age_login_defs" -F: '(/^[^:]+:[^!*]/ && ($5 > var || $5 == "")) {print $1}' /etc/shadow)
```
