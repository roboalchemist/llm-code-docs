# Source: https://docs.datadoghq.com/security/default_rules/def-000-2i0.md

---
title: Windows restricted software access by the Software Restriction Policies
description: Datadog, the leading service for cloud-scale monitoring.
breadcrumbs: >-
  Docs > Datadog Security > OOTB Rules > Windows restricted software access by
  the Software Restriction Policies
---

# Windows restricted software access by the Software Restriction Policies

{% alert level="danger" %}
This rule is part of a beta feature. To learn more, [contact Support](https://docs.datadoghq.com/help/).
{% /alert %}
Classification:attackTactic:[TA0002-execution](https://attack.mitre.org/tactics/TA0002)Technique:[T1204-user-execution](https://attack.mitre.org/techniques/T1204)
## Goal{% #goal %}

Detects instances where a user or process attempted to execute software that is restricted by Windows Software Restriction Policies (SRP).

## Strategy{% #strategy %}

This detection monitors Windows event logs with the provider "Microsoft-Windows-SoftwareRestrictionPolicies" and Event IDs 865, 866, 867, 868, or 882. These events indicate that SRP blocked the execution of a program based on path rules, hash rules, certificate rules, network zone rules, or AppLocker policy.

Software Restriction Policies are security controls that help administrators define which applications can run on workstations.

Software Restriction Policies were [deprecated](https://learn.microsoft.com/en-us/windows-server/identity/software-restriction-policies/software-restriction-policies) beginning with Windows 10 build 1803 and also applies to Windows Server 2019 and above.

## Triage & Response{% #triage--response %}

- Identify the `{{host}}` system where Software Restriction Policy blocked application execution.
- Examine the blocked application details, including file path, name, and hash values from the event.
- Determine which user account attempted to run the restricted application.
- Review process creation events to understand how the application was executed and its parent process.
- Investigate if the execution attempt originated from a remote machine by correlating with logon events.
- Check if the blocked application was being run with administrative privileges.
- Research the blocked application to determine if it's legitimate software needed for business or potentially malicious.
- Ensure the blocked file is quarantined or deleted if confirmed malware or unauthorized tool.
- Review the user's recent activities for evidence of potential compromise or policy violations.

## Changelog{% #changelog %}

- 22 September 2025 - Updated rule case from `High` to `Low`.
