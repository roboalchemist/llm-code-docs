# Source: https://docs.datadoghq.com/security/default_rules/8fc-9c9-c02.md

---
title: Google Cloud unauthorized service account activity
description: Datadog, the leading service for cloud-scale monitoring.
breadcrumbs: >-
  Docs > Datadog Security > OOTB Rules > Google Cloud unauthorized service
  account activity
---

# Google Cloud unauthorized service account activity
Classification:complianceTactic:[TA0001-initial-access](https://attack.mitre.org/tactics/TA0001)Technique:[T1078-valid-accounts](https://attack.mitre.org/techniques/T1078)
## Goal{% #goal %}

Detect when there is unauthorized activity by a service account in GCP.

## Strategy{% #strategy %}

Monitor Google Cloud logs and detect when a service account makes an API request and the request returns the status code equal to `7` within the log attribute `@data.protoPayload.status.code`. The status code `7` indicates the service account did not have permission to make the API call.

## Triage and response{% #triage-and-response %}

1. Investigate the service account:`{{@usr.id}}` that made the unauthorized calls and confirm if there is a misconfiguration in IAM permissions or if an attacker compromised the service account.
1. If unauthorized, revoke access of compromised service account and rotate credentials.

## Changelog{% #changelog %}

22 June 2022 - Updated query, rule case and triage.
