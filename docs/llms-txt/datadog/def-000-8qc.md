# Source: https://docs.datadoghq.com/security/default_rules/def-000-8qc.md

---
title: AWS ListResources by long term access key
description: Datadog, the leading service for cloud-scale monitoring.
breadcrumbs: >-
  Docs > Datadog Security > OOTB Rules > AWS ListResources by long term access
  key
---

# AWS ListResources by long term access key

{% alert level="danger" %}
This rule is part of a beta feature. To learn more, [contact Support](https://docs.datadoghq.com/help/).
{% /alert %}
Classification:attackTactic:[TA0007-discovery](https://attack.mitre.org/tactics/TA0007)Technique:[T1580-cloud-infrastructure-discovery](https://attack.mitre.org/techniques/T1580) 
## Goal{% #goal %}

Detects usage of long-term AWS access keys to execute `ListResources` operations in AWS Resource Explorer. Identifies potential unauthorized resource discovery and reconnaissance activity using compromised or misused long-term credentials.

## Strategy{% #strategy %}

This rule monitors AWS CloudTrail logs for `ListResources` events generated by the `resource-explorer-2.amazonaws.com` service, with a specific focus on long-term access keys. The `ListResources` API enables enumeration of AWS resources across accounts and regions, providing attackers with valuable information about the target environment's infrastructure. Long-term access keys present elevated security risks compared to temporary credentials due to their indefinite lifespan and higher likelihood of being compromised through credential theft, insider threats, or poor key management practices.

## Triage & Response{% #triage--response %}

- Examine if the access key `{{@userIdentity.accessKeyId}}` in region `{{@awsRegion}}` has legitimate authorization to list AWS resources.
- Review the user identity associated with the access key and verify if resource enumeration aligns with their job responsibilities.
- Analyze the scope and frequency of `ListResources` calls to determine if the activity indicates systematic reconnaissance.
- Investigate the source IP address and geographic location to identify potential unauthorized access patterns.
- Check for correlated Resource Explorer API calls such as `CreateIndex` or `GetIndex` from the same access key.
- Determine if the access key has been recently rotated or shows other signs of potential compromise.
- Validate if the resource listing activity occurs during expected business hours and aligns with known operational procedures.
