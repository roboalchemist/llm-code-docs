# Source: https://docs.datadoghq.com/security/default_rules/def-000-6g3.md

---
title: Malicious IP connected to PostgreSQL database
description: Datadog, the leading service for cloud-scale monitoring.
breadcrumbs: >-
  Docs > Datadog Security > OOTB Rules > Malicious IP connected to PostgreSQL
  database
---

# Malicious IP connected to PostgreSQL database
Classification:attackTactic:[TA0043-reconnaissance](https://attack.mitre.org/tactics/TA0043)Technique:[T1595-active-scanning](https://attack.mitre.org/techniques/T1595)
## Goal{% #goal %}

Detect database connections from IP addresses that are identified as malicious. Network access to database servers should be restricted.

## Strategy{% #strategy %}

This rule monitors logs from PostgreSQL to detect when a connection originates from an IP identified as malicious. Datadog enriches all ingested logs with [threat intelligence](https://docs.datadoghq.com/security/threat_intelligence/) in real time.

A `High` signal is generated if the connection resulted in a successful login. A `Low` signal is generated if there was no login attempt or the login attempt failed.

## Triage and response{% #triage-and-response %}

1. Determine if the user `{{ @db.user }}` is expected to authenticate from the IP `{{ @network.client.ip }}`.
1. Restrict network access to the database. Remove any public access.
1. If the login was successful review database logs for suspicious actions taken by the user `{{ @db.user }}`.
1. Rotate credentials for the affected account.
