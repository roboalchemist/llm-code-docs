# Source: https://docs.datadoghq.com/security/default_rules/def-000-43h.md

---
title: Elasticsearch domains should use at least three data nodes
description: Datadog, the leading service for cloud-scale monitoring.
breadcrumbs: >-
  Docs > Datadog Security > OOTB Rules > Elasticsearch domains should use at
  least three data nodes
---

# Elasticsearch domains should use at least three data nodes

## Description{% #description %}

This control checks whether Elasticsearch domains have at least three data nodes and ensures the zoneAwarenessEnabled setting is activated. To achieve high availability and fault tolerance, an Elasticsearch domain should be configured with at least three data nodes. This ensures that the cluster can continue to function even if one node fails.

## Remediation{% #remediation %}

To modify the number of data nodes in an Elasticsearch domain:

1. Log in to the [Amazon OpenSearch Service console](https://console.aws.amazon.com/aos/).
1. Under `Domains`, choose the name of the domain you want to edit.
1. Click `Edit domain`.
1. Under `Data nodes`, set `Number of nodes` to a number greater than or equal to 3.
1. For three Availability Zone deployments, set to a multiple of three to ensure equal distribution across Availability Zones.
1. Click `Submit`.
