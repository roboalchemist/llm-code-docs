# Source: https://onnxruntime.ai/docs/execution-providers/plugin-ep-libraries.html

# [![](data:image/svg+xml;base64,PHN2ZyB2aWV3Ym94PSIwIDAgMTYgMTYiIGFyaWEtaGlkZGVuPSJ0cnVlIj48dXNlIHhsaW5rOmhyZWY9IiNzdmctbGluayIgLz48L3N2Zz4=)](#plugin-execution-provider-libraries) Plugin Execution Provider Libraries 

## [![](data:image/svg+xml;base64,PHN2ZyB2aWV3Ym94PSIwIDAgMTYgMTYiIGFyaWEtaGlkZGVuPSJ0cnVlIj48dXNlIHhsaW5rOmhyZWY9IiNzdmctbGluayIgLz48L3N2Zz4=)](#contents) Contents 

- [Background](#background)
- [Creating a plugin EP library](#creating-a-plugin-ep-library)
  - [Defining an OrtEp](#defining-an-ortep)
  - [Defining an OrtEpFactory](#defining-an-ortepfactory)
  - [Exporting functions to create and release factories](#exporting-functions-to-create-and-release-factories)
- [Using a plugin EP library](#using-a-plugin-ep-library)
  - [Plugin EP library registration](#plugin-ep-library-registration)
  - [Session creation with explicit OrtEpDevice(s)](#session-creation-with-explicit-ortepdevices)
  - [Session creation with automatic EP selection](#session-creation-with-automatic-ep-selection)
- [API reference](#api-reference)
  - [Data Types](#data-types)
  - [Plugin EP Library Registration APIs](#plugin-ep-library-registration-apis)

## [![](data:image/svg+xml;base64,PHN2ZyB2aWV3Ym94PSIwIDAgMTYgMTYiIGFyaWEtaGlkZGVuPSJ0cnVlIj48dXNlIHhsaW5rOmhyZWY9IiNzdmctbGluayIgLz48L3N2Zz4=)](#background) Background

An ONNX Runtime Execution Provider (EP) executes model operations on one or more hardware accelerators (e.g., GPU, NPU, etc.). ONNX Runtime provides a variety of built-in EPs, such as the default CPU EP. To enable further extensibility, ONNX Runtime supports user-defined plugin EP libraries that an application can register with ONNX Runtime for use in an ONNX Runtime inference session.\

This page provides a reference for the APIs necessary to develop and use plugin EP libraries with ONNX Runtime.

## [![](data:image/svg+xml;base64,PHN2ZyB2aWV3Ym94PSIwIDAgMTYgMTYiIGFyaWEtaGlkZGVuPSJ0cnVlIj48dXNlIHhsaW5rOmhyZWY9IiNzdmctbGluayIgLz48L3N2Zz4=)](#creating-a-plugin-ep-library) Creating a plugin EP library

A plugin EP is built as a dynamic/shared library that exports the functions `CreateEpFactories()` and `ReleaseEpFactory()`. ONNX Runtime calls `CreateEpFactories()` to obtain one or more instances of `OrtEpFactory`. An `OrtEpFactory` creates `OrtEp` instances and specifies the hardware devices supported by the EPs it creates.

The ONNX Runtime repository includes a [sample plugin EP library](https://github.com/microsoft/onnxruntime/tree/main/onnxruntime/test/autoep/library), which is referenced in the following sections.

### [![](data:image/svg+xml;base64,PHN2ZyB2aWV3Ym94PSIwIDAgMTYgMTYiIGFyaWEtaGlkZGVuPSJ0cnVlIj48dXNlIHhsaW5rOmhyZWY9IiNzdmctbGluayIgLz48L3N2Zz4=)](#defining-an-ortep) Defining an OrtEp

An `OrtEp` represents an instance of an EP that is used by an ONNX Runtime session to identify and execute the model operations supported by the EP.

The following table lists the **required** variables and functions that an implementer must define for an `OrtEp`.

  -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
  Field                     Summary                                                                                                                                                                           Example implementation
  ------------------------- --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
  ort_version_supported     The ONNX Runtime version with which the EP was compiled. Implementation should set to `ORT_API_VERSION`.                                                                          [ExampleEp()](https://github.com/microsoft/onnxruntime/blob/16ae99ede405d3d6c59d7cce80c53f5f7055aeed/onnxruntime/test/autoep/library/ep.cc#L160)

  GetName                   Get the execution provider name.                                                                                                                                                  [ExampleEp::GetNameImpl()](https://github.com/microsoft/onnxruntime/blob/16ae99ede405d3d6c59d7cce80c53f5f7055aeed/onnxruntime/test/autoep/library/ep.cc#L181)

  GetCapability             Get information about the nodes/subgraphs supported by the `OrtEp` instance.                                                                                                      [ExampleEp::GetCapabilityImpl()](https://github.com/microsoft/onnxruntime/blob/16ae99ede405d3d6c59d7cce80c53f5f7055aeed/onnxruntime/test/autoep/library/ep.cc#L231)

  Compile                   Compile `OrtGraph` instances assigned to the `OrtEp`. Implementation must set a `OrtNodeComputeInfo` instance for each `OrtGraph` in order to define its computation function.\   [ExampleEp::CompileImpl()](https://github.com/microsoft/onnxruntime/blob/16ae99ede405d3d6c59d7cce80c53f5f7055aeed/onnxruntime/test/autoep/library/ep.cc#L293)
                            \                                                                                                                                                                                 
                            If the session is configured to generate a pre-compiled model, the execution provider must return `count` number of EPContext nodes.                                              

  ReleaseNodeComputeInfos   Release `OrtNodeComputeInfo` instances.                                                                                                                                           [ExampleEp::ReleaseNodeComputeInfosImpl()](https://github.com/microsoft/onnxruntime/blob/16ae99ede405d3d6c59d7cce80c53f5f7055aeed/onnxruntime/test/autoep/library/ep.cc#L364)
  -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

The following table lists the **optional** functions that an implementor may define for an `OrtEp`. If an optional `OrtEp` function is not defined, ONNX Runtime uses a default implementation.

  -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
  Field                               Summary                                                                                                                                                                                                                                                                                                                            Example implementation
  ----------------------------------- ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- ------------------------
  GetPreferredDataLayout              Get the EP\'s preferred data layout.\                                                                                                                                                                                                                                                                                              
                                      \                                                                                                                                                                                                                                                                                                                                  
                                      If this function is not implemented, ORT assumes that the EP prefers the data layout `OrtEpDataLayout::NCHW`.                                                                                                                                                                                                                      

  ShouldConvertDataLayoutForOp        Given an op with domain `domain` and type `op_type`, determine whether an associated node\'s data layout should be converted to a `target_data_layout`. If the EP prefers a non-default data layout, this function will be called during layout transformation with `target_data_layout` set to the EP\'s preferred data layout\   
                                      \                                                                                                                                                                                                                                                                                                                                  
                                      Implementation of this function is optional. If an EP prefers a non-default data layout, it may implement this to customize the specific op data layout preferences at a finer granularity.                                                                                                                                        

  SetDynamicOptions                   Set dynamic options on this EP. Dynamic options can be set by the application at any time after session creation with [`OrtApi::SetEpDynamicOptions()`](https://onnxruntime.ai/docs/api/c/struct_ort_api.html#ab1117a51683e4fbb42687c9db6e8d5fb).\                                                                                 
                                      \                                                                                                                                                                                                                                                                                                                                  
                                      Implementation of this function is optional. An EP should only implement this function if it needs to handle any dynamic options.                                                                                                                                                                                                  

  OnRunStart                          Called by ORT to notify the EP of the start of a run.\                                                                                                                                                                                                                                                                             
                                      \                                                                                                                                                                                                                                                                                                                                  
                                      Implementation of this function is optional. An EP should only implement this function if it needs to handle application-provided options at the start of a run.                                                                                                                                                                   

  OnRunEnd                            Called by ORT to notify the EP of the end of a run.\                                                                                                                                                                                                                                                                               
                                      \                                                                                                                                                                                                                                                                                                                                  
                                      Implementation of this function is optional. An EP should only implement this function if it needs to handle application-provided options at the end of a run.                                                                                                                                                                     

  CreateAllocator                     Create an `OrtAllocator` for the given `OrtMemoryInfo` for an `OrtSession`.\                                                                                                                                                                                                                                                       
                                      \                                                                                                                                                                                                                                                                                                                                  
                                      The `OrtMemoryInfo` instance will match one of the values set in the `OrtEpDevice` using `EpDevice_AddAllocatorInfo`. Any allocator specific options should be read from the session options.\                                                                                                                                     
                                      \                                                                                                                                                                                                                                                                                                                                  
                                      Implementation of this function is optional. If not provided, ORT will use \`OrtEpFactory::CreateAllocator()\`.                                                                                                                                                                                                                    

  CreateSyncStreamForDevice           Create a synchronization stream for the given memory device for an `OrtSession`.\                                                                                                                                                                                                                                                  
                                      \                                                                                                                                                                                                                                                                                                                                  
                                      This is used to create a synchronization stream for the execution provider and is used to synchronize operations on the device during model execution. Any stream specific options should be read from the session options.\                                                                                                       
                                      \                                                                                                                                                                                                                                                                                                                                  
                                      Implementation of this function is optional. If not provided, ORT will use \`OrtEpFactory::CreateSyncStreamForDevice()\`.                                                                                                                                                                                                          

  GetCompiledModelCompatibilityInfo   Get a string with details about the EP stack used to produce a compiled model.\                                                                                                                                                                                                                                                    
                                      \                                                                                                                                                                                                                                                                                                                                  
                                      The compatibility information string can be used with `OrtEpFactory::ValidateCompiledModelCompatibilityInfo` to determine if a compiled model is compatible with the EP.                                                                                                                                                           
  -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

### [![](data:image/svg+xml;base64,PHN2ZyB2aWV3Ym94PSIwIDAgMTYgMTYiIGFyaWEtaGlkZGVuPSJ0cnVlIj48dXNlIHhsaW5rOmhyZWY9IiNzdmctbGluayIgLz48L3N2Zz4=)](#defining-an-ortepfactory) Defining an OrtEpFactory

An `OrtEpFactory` represents an instance of an EP factory that is used by an ONNX Runtime session to query device support, create allocators, create data transfer objects, and create instances of an EP (i.e., an `OrtEp`).

The following table lists the **required** variables and functions that an implementer must define for an `OrtEpFactory`.

  Field                   Summary                                                                                                                                                                                        Example implementation
  ----------------------- ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
  ort_version_supported   The ONNX Runtime version with which the EP was compiled. Implementation should set this to `ORT_API_VERSION`.                                                                                  [ExampleEpFactory()](https://github.com/microsoft/onnxruntime/blob/3cadbdb495761a6a54845b178f9bdb811a2c8bde/onnxruntime/test/autoep/library/ep_factory.cc#L16)
  GetName                 Get the name of the EP that the factory creates. Must match `OrtEp::GetName()`.                                                                                                                [ExampleEpFactory::GetNameImpl()](https://github.com/microsoft/onnxruntime/blob/3cadbdb495761a6a54845b178f9bdb811a2c8bde/onnxruntime/test/autoep/library/ep_factory.cc#L77)
  GetVendor               Get the name of the name of the vendor that owns the EP that the factory creates.                                                                                                              [ExampleEpFactory::GetVendor()](https://github.com/microsoft/onnxruntime/blob/3cadbdb495761a6a54845b178f9bdb811a2c8bde/onnxruntime/test/autoep/library/ep_factory.cc#L83)
  GetVendorId             Get the vendor ID of the vendor that owns the EP that the factory creates. This is typically the [PCI vendor ID](https://pcisig.com/membership/member-companies).                              [ExampleEpFactory::GetVendorId()](https://github.com/microsoft/onnxruntime/blob/3cadbdb495761a6a54845b178f9bdb811a2c8bde/onnxruntime/test/autoep/library/ep_factory.cc#L89)
  GetVersion              Get the version of the EP that the factory creates. The version string should adhere to the [Semantic Versioning 2.0 specification](https://github.com/semver/semver/blob/v2.0.0/semver.md).   [ExampleEpFactory::GetVersionImpl()](https://github.com/microsoft/onnxruntime/blob/3cadbdb495761a6a54845b178f9bdb811a2c8bde/onnxruntime/test/autoep/library/ep_factory.cc#L95)
  GetSupportedDevices     Get information about the `OrtHardwareDevice` instances supported by an EP created by the factory.                                                                                             [ExampleEpFactory::GetSupportedDevicesImpl()](https://github.com/microsoft/onnxruntime/blob/3cadbdb495761a6a54845b178f9bdb811a2c8bde/onnxruntime/test/autoep/library/ep_factory.cc#L101)
  CreateEp                Creates an `OrtEp` instance for use in an ONNX Runtime session. ORT calls `OrtEpFactory::ReleaseEp()` to release the instance.                                                                 [ExampleEpFactory::CreateEpImpl()](https://github.com/microsoft/onnxruntime/blob/3cadbdb495761a6a54845b178f9bdb811a2c8bde/onnxruntime/test/autoep/library/ep_factory.cc#L163)

The following table lists the **optional** functions that an implementer may define for an `OrtEpFactory`.

  -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
  Field                                    Summary                                                                                                                                                                                                                                                                             Example implementation
  ---------------------------------------- ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
  ValidateCompiledModelCompatibilityInfo   Validate the compatibility of a compiled model with the EP.\                                                                                                                                                                                                                        
                                           \                                                                                                                                                                                                                                                                                   
                                           This function validates if a model produced with the supllied compatibility information string is supported by the underlying EP. The implementation should check if a compiled model is compatible with the EP and return the appropriate `OrtCompiledModelCompatibility` value.   

  CreateAllocator                          Create an `OrtAllocator` that can be shared across sessions for the given `OrtMemoryInfo`.\                                                                                                                                                                                         [ExampleEpFactory::CreateAllocatorImpl()](https://github.com/microsoft/onnxruntime/blob/3cadbdb495761a6a54845b178f9bdb811a2c8bde/onnxruntime/test/autoep/library/ep_factory.cc#L212)
                                           \                                                                                                                                                                                                                                                                                   
                                           The factory that creates the EP is responsible for providing the allocators required by the EP. The `OrtMemoryInfo` instance will match one of the values set in the `OrtEpDevice` using `EpDevice_AddAllocatorInfo`.                                                               

  ReleaseAllocator                         Releases an `OrtAllocator` instance created by the factory.                                                                                                                                                                                                                         [ExampleEpFactory::ReleaseAllocatorImpl()](https://github.com/microsoft/onnxruntime/blob/3cadbdb495761a6a54845b178f9bdb811a2c8bde/onnxruntime/test/autoep/library/ep_factory.cc#L272)

  CreateDataTransfer                       Creates an `OrtDataTransferImpl` instance for the factory.\                                                                                                                                                                                                                         [ExampleEpFactory::CreateDataTransferImpl()](https://github.com/microsoft/onnxruntime/blob/3cadbdb495761a6a54845b178f9bdb811a2c8bde/onnxruntime/test/autoep/library/ep_factory.cc#L286)
                                           \                                                                                                                                                                                                                                                                                   
                                           An `OrtDataTransferImpl` can be used to copy data between devices that the EP supports.                                                                                                                                                                                             

  IsStreamAware                            Returns true if the EPs created by the factory are stream-aware.                                                                                                                                                                                                                    [ExampleEpFactory::IsStreamAwareImpl()](https://github.com/microsoft/onnxruntime/blob/3cadbdb495761a6a54845b178f9bdb811a2c8bde/onnxruntime/test/autoep/library/ep_factory.cc#L295)

  CreateSyncStreamForDevice                Creates a synchronization stream for the given `OrtMemoryDevice`.\                                                                                                                                                                                                                  [ExampleEpFactory::CreateSyncStreamForDeviceImpl()](https://github.com/microsoft/onnxruntime/blob/3cadbdb495761a6a54845b178f9bdb811a2c8bde/onnxruntime/test/autoep/library/ep_factory.cc#L300)
                                           \                                                                                                                                                                                                                                                                                   
                                           This is use to create a synchronization stream for the `OrtMemoryDevice` that can be used for operations outside of a session.                                                                                                                                                      
  -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

### [![](data:image/svg+xml;base64,PHN2ZyB2aWV3Ym94PSIwIDAgMTYgMTYiIGFyaWEtaGlkZGVuPSJ0cnVlIj48dXNlIHhsaW5rOmhyZWY9IiNzdmctbGluayIgLz48L3N2Zz4=)](#exporting-functions-to-create-and-release-factories) Exporting functions to create and release factories

ONNX Runtime expects a plugin EP library to export certain functions/symbols. The following table lists the functions that have to be exported from the plugin EP library.

  Function            Description                                                               Example implementation
  ------------------- ------------------------------------------------------------------------- ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
  CreateEpFactories   ONNX Runtime calls this function to create `OrtEpFactory` instances.      [ExampleEp: CreateEpFactories](https://github.com/microsoft/onnxruntime/blob/3cadbdb495761a6a54845b178f9bdb811a2c8bde/onnxruntime/test/autoep/library/example_plugin_ep.cc#L17)
  ReleaseEpFactory    ONNX Runtime calls this function to release an `OrtEpFactory` instance.   [ExampleEp: ReleaseEpFactory](https://github.com/microsoft/onnxruntime/blob/3cadbdb495761a6a54845b178f9bdb811a2c8bde/onnxruntime/test/autoep/library/example_plugin_ep.cc#L41)

## [![](data:image/svg+xml;base64,PHN2ZyB2aWV3Ym94PSIwIDAgMTYgMTYiIGFyaWEtaGlkZGVuPSJ0cnVlIj48dXNlIHhsaW5rOmhyZWY9IiNzdmctbGluayIgLz48L3N2Zz4=)](#using-a-plugin-ep-library) Using a plugin EP library

### [![](data:image/svg+xml;base64,PHN2ZyB2aWV3Ym94PSIwIDAgMTYgMTYiIGFyaWEtaGlkZGVuPSJ0cnVlIj48dXNlIHhsaW5rOmhyZWY9IiNzdmctbGluayIgLz48L3N2Zz4=)](#plugin-ep-library-registration) Plugin EP library registration

The sample application code below uses the following API functions to register and unregister a plugin EP library.

- [RegisterExecutionProviderLibrary](https://onnxruntime.ai/docs/api/c/struct_ort_api.html#a7c8ea74a2ee54d03052f3d7cd1e1335d)
- [UnregisterExecutionProviderLibrary](https://onnxruntime.ai/docs/api/c/struct_ort_api.html#acd4d148e149af2f2304a45b65891543f)

``` highlight
const char* lib_registration_name = "ep_lib_name";
Ort::Env env;

// Register plugin EP library with ONNX Runtime.
env.RegisterExecutionProviderLibrary(
  lib_registration_name,   // Registration name can be anything the application chooses.
  ORT_TSTR("ep_path.dll")  // Path to the plugin EP library.
);

// Unregister the library using the application-specified registration name.
// Must only unregister a library after all sessions that use the library have been released.
env.UnregisterExecutionProviderLibrary(lib_registration_name);
```

As shown in the following sequence diagram, registering a plugin EP library causes ONNX Runtime to load the library and call the library's `CreateEpFactories()` function. During the call to `CreateEpFactories()`, ONNX Runtime determines the subset of hardware devices supported by each factory by calling `OrtEpFactory::GetSupportedDevices()` with all hardware devices that ONNX Runtime discovered during initialization.

The factory returns `OrtEpDevice` instances from `OrtEpFactory::GetSupportedDevices()`. Each `OrtEpDevice` instance pairs a factory with a hardware device that the factory supports. For example, if a single factory instance supports both CPU and NPU, then the call to `OrtEpFactory::GetSupportedDevices()` returns two `OrtEpDevice` instances:

- ep_device_0: (factory_0, CPU)
- ep_device_1: (factory_0, NPU)

\

![Sequence diagram showing registration and unregistration of a plugin EP library](../../images/plugin_ep_sd_lib_reg.png)

### [![](data:image/svg+xml;base64,PHN2ZyB2aWV3Ym94PSIwIDAgMTYgMTYiIGFyaWEtaGlkZGVuPSJ0cnVlIj48dXNlIHhsaW5rOmhyZWY9IiNzdmctbGluayIgLz48L3N2Zz4=)](#session-creation-with-explicit-ortepdevices) Session creation with explicit OrtEpDevice(s)

The application code below uses the API function [SessionOptionsAppendExecutionProvider_V2](https://onnxruntime.ai/docs/api/c/struct_ort_api.html#a285a5da8c9a63eff55dc48e4cf3b56f6) to add an EP from a library to an ONNX Runtime session.

The application first calls [GetEpDevices](https://onnxruntime.ai/docs/api/c/struct_ort_api.html#a52107386ff1be870f55a0140e6add8dd) to get a list of `OrtEpDevices` available to the application. Each `OrtEpDevice` represents a hardware device supported by an `OrtEpFactory`. The `SessionOptionsAppendExecutionProvider_V2` function takes an array of `OrtEpDevice` instances as input, where all `OrtEpDevice` instances refer to the same `OrtEpFactory`.

``` highlight
Ort::Env env;
env.RegisterExecutionProviderLibrary(/*...*/);

;
  for (Ort::ConstEpDevice ep_device : ep_devices) 
  }

  if (selected_ep_devices[0] == nullptr) 

  Ort::KeyValuePairs ep_options(/*...*/);  // Optional EP options.
  Ort::SessionOptions session_options;
  session_options.AppendExecutionProvider_V2(env, selected_ep_devices, ep_options);

  Ort::Session session(env, ORT_TSTR("model.onnx"), session_options);

  // Run model ...
}

env.UnregisterExecutionProviderLibrary(/*...*/);
```

As shown in the following sequence diagram, ONNX Runtime calls `OrtEpFactory::CreateEp()` during session creation in order to create an instance of the plugin EP.

\

![Sequence diagram showing session creation with explicit ep devices](../../images/plugin_ep_sd_appendv2.png)

### [![](data:image/svg+xml;base64,PHN2ZyB2aWV3Ym94PSIwIDAgMTYgMTYiIGFyaWEtaGlkZGVuPSJ0cnVlIj48dXNlIHhsaW5rOmhyZWY9IiNzdmctbGluayIgLz48L3N2Zz4=)](#session-creation-with-automatic-ep-selection) Session creation with automatic EP selection

The application code below uses the API function [SessionOptionsSetEpSelectionPolicy](https://onnxruntime.ai/docs/api/c/struct_ort_api.html#a2ae116df2c6293e4094a6742a6c46f7e) to have ONNX Runtime automatically select an EP based on the user's policy (e.g., PREFER_NPU). If the plugin EP library registered with ONNX Runtime has a factory that supports NPU, then ONNX Runtime may select an EP from that factory to run the model.

``` highlight
Ort::Env env;
env.RegisterExecutionProviderLibrary(/*...*/);

env.UnregisterExecutionProviderLibrary(/*...*/);
```

\

![Sequence diagram showing session creation with automatic EP selection](../../images/plugin_ep_sd_autoep.png)

## [![](data:image/svg+xml;base64,PHN2ZyB2aWV3Ym94PSIwIDAgMTYgMTYiIGFyaWEtaGlkZGVuPSJ0cnVlIj48dXNlIHhsaW5rOmhyZWY9IiNzdmctbGluayIgLz48L3N2Zz4=)](#api-reference) API reference

API header files:

- [onnxruntime_ep_c_api.h](https://github.com/microsoft/onnxruntime/blob/main/include/onnxruntime/core/session/onnxruntime_ep_c_api.h)
  - Defines interfaces implemented by plugin EP and EP factory instances.
  - Provides APIs utilized by plugin EP and EP factory instances.
- [onnxruntime_c_api.h](https://github.com/microsoft/onnxruntime/blob/main/include/onnxruntime/core/session/onnxruntime_c_api.h)
  - Provides APIs used to traverse an input model graph.

### [![](data:image/svg+xml;base64,PHN2ZyB2aWV3Ym94PSIwIDAgMTYgMTYiIGFyaWEtaGlkZGVuPSJ0cnVlIj48dXNlIHhsaW5rOmhyZWY9IiNzdmctbGluayIgLz48L3N2Zz4=)](#data-types) Data Types

+-----------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Type                              | Description                                                                                                                                                                                                                                                                                                                                                                    |
+===================================+================================================================================================================================================================================================================================================================================================================================================================================+
| OrtHardwareDeviceType             | Enumerates classes of hardware devices:\                                                                                                                                                                                                                                                                                                                                       |
|                                   |                                                                                                                                                                                                                                                                                                                                                                                |
|                                   | - OrtHardwareDeviceType_CPU                                                                                                                                                                                                                                                                                                                                                    |
|                                   | - OrtHardwareDeviceType_GPU                                                                                                                                                                                                                                                                                                                                                    |
|                                   | - OrtHardwareDeviceType_NPU                                                                                                                                                                                                                                                                                                                                                    |
+-----------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| OrtHardwareDevice                 | Opaque type that represents a physical hardware device.                                                                                                                                                                                                                                                                                                                        |
+-----------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| OrtExecutionProviderDevicePolicy  | Enumerates the default EP selection policies available to users of ORT\'s automatic EP selection.                                                                                                                                                                                                                                                                              |
+-----------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| OrtEpDevice                       | Opaque type that represents a pairing of an EP and hardware device that can run a model or model subgraph.                                                                                                                                                                                                                                                                     |
+-----------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| OrtNodeFusionOptions              | Struct that contains options for fusing nodes supported by an EP.                                                                                                                                                                                                                                                                                                              |
+-----------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| OrtNodeComputeContext             | Opaque type that contains a compiled/fused node\'s name and host memory allocation functions. ONNX Runtime provides an instance of `OrtNodeComputeContext` as an argument to `OrtNodeComputeInfo::CreateState()`.                                                                                                                                                              |
+-----------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| OrtNodeComputeInfo                | Struct that contains the computation function for a compiled `OrtGraph` instance. Initialized by an `OrtEp` instance.                                                                                                                                                                                                                                                          |
+-----------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| OrtEpGraphSupportInfo             | Opaque type that contains information on the nodes supported by an EP. An instance of `OrtEpGraphSupportInfo` is passed to `OrtEp::GetCapability()` and the EP populates the `OrtEpGraphSupportInfo` instance with information on the nodes that it supports.                                                                                                                  |
+-----------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| OrtEpDataLayout                   | Enumerates the operator data layouts that could be preferred by an EP. By default, ONNX models use a \"channel-first\" layout (e.g., NCHW) but some EPs may prefer a \"channel-last\" layout (e.g., NHWC).                                                                                                                                                                     |
+-----------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| OrtMemoryDevice                   | Opaque type that represents a combination of a physical device and memory type. A memory allocation and allocator are associated with a specific `OrtMemoryDevice`, and this information is used to determine when data transfer is required.                                                                                                                                  |
+-----------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| OrtDataTransferImpl               | Struct of functions that an EP implements to copy data between the devices that the EP uses and CPU.                                                                                                                                                                                                                                                                           |
+-----------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| OrtSyncNotificationImpl           | Struct of functions that an EP implements for Stream notifications.                                                                                                                                                                                                                                                                                                            |
+-----------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| OrtSyncStreamImpl                 | Struct of functions that an EP implements if it needs to support Streams.                                                                                                                                                                                                                                                                                                      |
+-----------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| OrtEpFactory                      | A plugin EP library provides ORT with one or more instances of `OrtEpFactory`. An `OrtEpFactory` implements functions that are used by ORT to query device support, create allocators, create data transfer objects, and create instances of an EP (i.e., an `OrtEp` instance).\                                                                                               |
|                                   | An `OrtEpFactory` may support more than one hardware device (`OrtHardwareDevice`). If more than one hardware device is supported by the factory, an EP instance created by the factory is expected to internally partition any graph nodes assigned to the EP among its supported hardware devices.\                                                                           |
|                                   | Alternatively, if an EP library author needs ONNX Runtime to partition the graph nodes among different hardware devices supported by the EP library, then the EP library must provide multiple `OrtEpFactory` instances. Each `OrtEpFactory` instance must support one hardware device and must create an EP instance with a unique name (e.g., MyEP_CPU, MyEP_GPU, MyEP_NPU). |
+-----------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| OrtEp                             | An instance of an Ep that can execute model nodes on one or more hardware devices (`OrtHardwareDevice`). An `OrtEp` implements functions that are used by ORT to query graph node support, compile supported nodes, query preferred data layout, set run options, etc. An `OrtEpFactory` creates an `OrtEp` instance via the `OrtEpFactory::CreateEp()` function.              |
+-----------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| OrtRunOptions                     | Opaque object containing options passed to the `OrtApi::Run()` function, which runs a model.                                                                                                                                                                                                                                                                                   |
+-----------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| OrtGraph                          | Opaque type that represents a graph. Provided to `OrtEp` instances in calls to `OrtEp::GetCapability()` and `OrtEp::Compile()`.                                                                                                                                                                                                                                                |
+-----------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| OrtValueInfo                      | Opaque type that contains information for a value in a graph. A graph value can be a graph input, graph output, graph initializer, node input, or node output. An `OrtValueInfo` instance has the following information.\                                                                                                                                                      |
|                                   |                                                                                                                                                                                                                                                                                                                                                                                |
|                                   | - Type and shape (e.g., `OrtTypeInfo`)                                                                                                                                                                                                                                                                                                                                         |
|                                   | - `OrtNode` consumers                                                                                                                                                                                                                                                                                                                                                          |
|                                   | - `OrtNode` producer                                                                                                                                                                                                                                                                                                                                                           |
|                                   | - Information that classifies the value as a graph input, graph output, initializer, etc.                                                                                                                                                                                                                                                                                      |
+-----------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| OrtExternalInitializerInfo        | Opaque type that contains information for an initializer stored in an external file. An `OrtExternalInitializerInfo` instance contains the file path, file offset, and byte size for the initializer. Can be obtained from an `OrtValueInfo` via the function `ValueInfo_GetExternalInitializerInfo()`.                                                                        |
+-----------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| OrtTypeInfo                       | Opaque type that contains the element type and shape information for ONNX tensors, sequences, maps, sparse tensors, etc.                                                                                                                                                                                                                                                       |
+-----------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| OrtTensorTypeAndShapeInfo         | Opaque type that contains the element type and shape information for an ONNX tensor.                                                                                                                                                                                                                                                                                           |
+-----------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| OrtNode                           | Opaque type that represents a node in a graph.                                                                                                                                                                                                                                                                                                                                 |
+-----------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| OrtOpAttrType                     | Enumerates attribute types.                                                                                                                                                                                                                                                                                                                                                    |
+-----------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| OrtOpAttr                         | Opaque type that represents an ONNX operator attribute.                                                                                                                                                                                                                                                                                                                        |
+-----------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

### [![](data:image/svg+xml;base64,PHN2ZyB2aWV3Ym94PSIwIDAgMTYgMTYiIGFyaWEtaGlkZGVuPSJ0cnVlIj48dXNlIHhsaW5rOmhyZWY9IiNzdmctbGluayIgLz48L3N2Zz4=)](#plugin-ep-library-registration-apis) Plugin EP Library Registration APIs

The following table lists the API functions used for registration of a plugin EP library.

  ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
  Function                                                                                                                                Description
  --------------------------------------------------------------------------------------------------------------------------------------- --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
  [RegisterExecutionProviderLibrary](https://onnxruntime.ai/docs/api/c/struct_ort_api.html#a7c8ea74a2ee54d03052f3d7cd1e1335d)             Register an EP library with ORT. The library must export the `CreateEpFactories` and `ReleaseEpFactory` functions.

  [UnregisterExecutionProviderLibrary](https://onnxruntime.ai/docs/api/c/struct_ort_api.html#acd4d148e149af2f2304a45b65891543f)           Unregister an EP library with ORT. Caller **MUST** ensure there are no `OrtSession` instances using the EPs created by the library before calling this function.

  [GetEpDevices](https://onnxruntime.ai/docs/api/c/struct_ort_api.html#a52107386ff1be870f55a0140e6add8dd)                                 Get the list of available OrtEpDevice instances.\
                                                                                                                                          \
                                                                                                                                          Each `OrtEpDevice` instance contains details of the execution provider and the device it will use.

  [SessionOptionsAppendExecutionProvider_V2](https://onnxruntime.ai/docs/api/c/struct_ort_api.html#a285a5da8c9a63eff55dc48e4cf3b56f6)     Append the execution provider that is responsible for the provided `OrtEpDevice` instances to the session options.

  [SessionOptionsSetEpSelectionPolicy](https://onnxruntime.ai/docs/api/c/struct_ort_api.html#a2ae116df2c6293e4094a6742a6c46f7e)           Set the execution provider selection policy for the session.\
                                                                                                                                          \
                                                                                                                                          Allows users to specify a device selection policy for automatic EP selection. If custom selection is required please use `SessionOptionsSetEpSelectionPolicyDelegate` instead.

  [SessionOptionsSetEpSelectionPolicyDelegate](https://onnxruntime.ai/docs/api/c/struct_ort_api.html#a29c026bc7aa6672f93b7f9e31fd3e4a7)   Set the execution provider selection policy delegate for the session.\
                                                                                                                                          \
                                                                                                                                          Allows users to provide a custom device selection policy for automatic EP selection.
  ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------