# Source: https://fly.io/docs/monitoring/exporting-logs/

Title: Export logs

URL Source: https://fly.io/docs/monitoring/exporting-logs/

Markdown Content:
Export logs · Fly Docs
===============

[Skip to content](https://fly.io/docs/monitoring/exporting-logs/#main-content-start)

[](https://fly.io/)[](https://fly.io/docs/)

[**Need a Logo?** View Our Brand Assets](https://fly.io/docs/about/brand/)

Search

Open main menu[](https://fly.io/)[](https://fly.io/docs/)

[Pricing](https://fly.io/pricing/)[Support](https://fly.io/docs/about/support/)

[Sign In](https://fly.io/app/sign-in/)[Sign Up](https://fly.io/app/sign-up/)

[Getting Started](https://fly.io/docs/getting-started/launch)Toggle Getting Started section
*   [Quickstart: Launch your app](https://fly.io/docs/getting-started/launch/)
*   [Launch HelloFly Demo App](https://fly.io/docs/getting-started/launch-demo)
*   [Deep Dive Demo App](https://fly.io/docs/deep-dive/)
*   [Choose a Language or Framework](https://fly.io/docs/getting-started/get-started-by-framework/)
*   [Fly.io Essentials](https://fly.io/docs/getting-started/essentials/)
*   [Migrate from Heroku](https://fly.io/docs/getting-started/migrate-from-heroku/)
*   [Troubleshoot Deployments](https://fly.io/docs/getting-started/troubleshooting/)

[Guides (Blueprints)](https://fly.io/docs/blueprints/)Toggle Guides (Blueprints) section
*   [Guides Overview](https://fly.io/docs/blueprints/)

[Apps on Fly.io](https://fly.io/docs/apps/overview)Toggle Apps on Fly.io section
*   [Fly Apps Overview](https://fly.io/docs/apps/overview/)
*   [Fly Launch](https://fly.io/docs/launch/)
*   [Secrets](https://fly.io/docs/apps/secrets/)
*   [Production Checklist](https://fly.io/docs/apps/going-to-production/)

[Languages & Frameworks](https://fly.io/docs/languages-and-frameworks/)Toggle Languages & Frameworks section
*   [Elixir](https://fly.io/docs/elixir/)
*   [Rails](https://fly.io/docs/rails/getting-started/)
*   [Laravel](https://fly.io/docs/laravel/)
*   [Django](https://fly.io/docs/django/getting-started/)
*   [JavaScript](https://fly.io/docs/js/)
*   [Rust](https://fly.io/docs/rust/)
*   [Python](https://fly.io/docs/python/)
*   [More...](https://fly.io/docs/languages-and-frameworks/)

[Fly Machines](https://fly.io/docs/machines/overview)Toggle Fly Machines section
*   [Introduction to Fly Machines](https://fly.io/docs/machines/overview/)
*   [Machines API](https://fly.io/docs/machines/api/)
*   [Run a New Machine](https://fly.io/docs/machines/flyctl/fly-machine-run/)
*   [Update a Machine](https://fly.io/docs/machines/flyctl/fly-machine-update/)
*   [Machine Sizing](https://fly.io/docs/machines/guides-examples/machine-sizing/)
*   [Machine Restart Policy](https://fly.io/docs/machines/guides-examples/machine-restart-policy/)
*   [Machine States](https://fly.io/docs/machines/machine-states/)
*   [Run User Code on Fly Machines](https://fly.io/docs/machines/guides-examples/functions-with-machines/)
*   [One App Per Customer - Why?](https://fly.io/docs/machines/guides-examples/one-app-per-user-why/)
*   [The Machine Runtime Environment](https://fly.io/docs/machines/runtime-environment/)

[Managed Postgres](https://fly.io/docs/mpg)Toggle Managed Postgres section
*   [Create and Connect to a Managed Postgres Cluster](https://fly.io/docs/mpg/create-and-connect/)
*   [Cluster Configuration Options](https://fly.io/docs/mpg/configuration/)
*   [Phoenix with Managed Postgres](https://fly.io/docs/mpg/guides-examples/phoenix-guide/)
*   [Monitoring and Metrics](https://fly.io/docs/mpg/metrics/)
*   [Import data from another postgres cluster](https://fly.io/docs/mpg/import/)
*   [Supported Postgres Extensions](https://fly.io/docs/mpg/extensions/)

[Fly GPUs](https://fly.io/docs/gpus/gpu-quickstart)Toggle Fly GPUs section
*   [GPU Quickstart](https://fly.io/docs/gpus/gpu-quickstart/)
*   [Getting Started with GPU Machines](https://fly.io/docs/gpus/getting-started-gpus/)
*   [Python GPU Dev Machine](https://fly.io/docs/gpus/python-gpu-example/)

[Databases & Storage](https://fly.io/docs/database-storage-guides/)Toggle Databases & Storage section
*   [Fly Managed Postgres](https://fly.io/docs/mpg/)
*   [Tigris Object Storage](https://fly.io/docs/tigris/)
*   [Upstash for Redis®](https://fly.io/docs/upstash/redis/)

[Fly Volumes](https://fly.io/docs/volumes/overview)Toggle Fly Volumes section
*   [Fly Volumes Overview](https://fly.io/docs/volumes/overview/)
*   [Create and Manage Volumes](https://fly.io/docs/volumes/volume-manage/)
*   [Manage Volume Snapshots](https://fly.io/docs/volumes/snapshots/)
*   [Volume States](https://fly.io/docs/volumes/volume-states/)

[Fly Kubernetes](https://fly.io/docs/kubernetes/fks-quickstart)Toggle Fly Kubernetes section
*   [Fly Kubernetes Quickstart](https://fly.io/docs/kubernetes/fks-quickstart/)
*   [Fly Kubernetes Features](https://fly.io/docs/kubernetes/fks-features/)
*   [Create an FKS Cluster](https://fly.io/docs/kubernetes/clusters/)
*   [Connect to an FKS Cluster](https://fly.io/docs/kubernetes/connect-clusters/)
*   [Configure FKS Services](https://fly.io/docs/kubernetes/services/)
*   [Use GPUs with FKS](https://fly.io/docs/kubernetes/using-gpus/)
*   [Use Volumes with FKS](https://fly.io/docs/kubernetes/using-volumes/)

[Networking](https://fly.io/docs/networking/)Toggle Networking section
*   [Connect to an App Service](https://fly.io/docs/networking/app-services/)
*   [Public Networking](https://fly.io/docs/networking/services/)
*   [Private Networking](https://fly.io/docs/networking/private-networking/)
*   [Custom Private Networks](https://fly.io/docs/networking/custom-private-networks/)
*   [Flycast - Private Proxy Services](https://fly.io/docs/networking/flycast/)
*   [Egress IP Addresses](https://fly.io/docs/networking/egress-ips/)
*   [Dynamic Request Routing](https://fly.io/docs/networking/dynamic-request-routing/)
*   [Custom Domains](https://fly.io/docs/networking/custom-domain/)
*   [Understanding Cloudflare](https://fly.io/docs/networking/understanding-cloudflare/)
*   [Request Headers](https://fly.io/docs/networking/request-headers/)
*   [Run UDP Services](https://fly.io/docs/networking/udp-and-tcp/)
*   [TLS Support](https://fly.io/docs/networking/tls/)

[Monitoring](https://fly.io/docs/monitoring/)Toggle Monitoring section
*   [Metrics](https://fly.io/docs/monitoring/metrics/)
*   [Sentry Error Tracking](https://fly.io/docs/monitoring/sentry/)
*   [Logging](https://fly.io/docs/monitoring/logging-overview/)Toggle Logging section
    *   [Live Tail Logs](https://fly.io/docs/monitoring/live-tail-logs/)
    *   [Logs API Options](https://fly.io/docs/monitoring/logs-api-options/)
    *   [Search Logs](https://fly.io/docs/monitoring/search-logs/)
    *   [Export Logs](https://fly.io/docs/monitoring/exporting-logs/)
    *   [Error Codes](https://fly.io/docs/monitoring/error-codes/)

[Security](https://fly.io/docs/security/)Toggle Security section
*   [Organization Roles and Permissions](https://fly.io/docs/security/org-roles-permissions/)
*   [SSO for Organizations](https://fly.io/docs/security/sso/)
*   [Remove a Member from an Org](https://fly.io/docs/security/remove-org-member/)
*   [TLS Termination](https://fly.io/docs/security/tls-termination/)
*   [App Security by Arcjet](https://fly.io/docs/security/arcjet/)
*   [Access Tokens](https://fly.io/docs/security/tokens/)
*   [OpenID Connect](https://fly.io/docs/reference/openid-connect/)
*   [Shared Responsibility Model](https://fly.io/docs/security/shared-responsibility/)
*   [Security Practices and Compliance](https://fly.io/docs/security/security-at-fly-io/)

[Reference](https://fly.io/docs/reference/)Toggle Reference section
*   [flyctl](https://fly.io/docs/flyctl/)
*   [App Config Reference (fly.toml)](https://fly.io/docs/reference/configuration/)
*   [Architecture](https://fly.io/docs/reference/architecture/)
*   [Autoscaling](https://fly.io/docs/reference/autoscaling/)
*   [AWS to Fly Overview](https://fly.io/docs/reference/aws-to-fly-guide/)
*   [Builders](https://fly.io/docs/reference/builders/)
*   [Content Encoding](https://fly.io/docs/reference/content-encoding/)
*   [Fly Launch](https://fly.io/docs/reference/fly-launch/)
*   [Health Checks](https://fly.io/docs/reference/health-checks/)
*   [Load Balancing](https://fly.io/docs/reference/load-balancing/)
*   [Machine Migration](https://fly.io/docs/reference/machine-migration/)
*   [Multiple Processes in Apps](https://fly.io/docs/app-guides/multiple-processes/)
*   [Fly Proxy](https://fly.io/docs/reference/fly-proxy/)
*   [Fly Proxy Autostop/Autostart](https://fly.io/docs/reference/fly-proxy-autostop-autostart/)
*   [Regions](https://fly.io/docs/reference/regions/)
*   [Suspend/Resume](https://fly.io/docs/reference/suspend-resume/)

[About](https://fly.io/docs/about/)Toggle About section
*   [Pricing](https://fly.io/docs/about/pricing/)
*   [Billing](https://fly.io/docs/about/billing/)
*   [Cost Management](https://fly.io/docs/about/cost-management/)
*   [Free Trial](https://fly.io/docs/about/free-trial/)
*   [Support](https://fly.io/docs/about/support/)
*   [Engineering Jobs](https://fly.io/docs/hiring/)
*   [Healthcare on Fly.io](https://fly.io/docs/about/healthcare/)
*   [Extensions Program](https://fly.io/docs/about/extensions/)
*   [Extensions API](https://fly.io/docs/reference/extensions_api/)
*   [Merch](https://fly.io/docs/about/merch/)
*   [Open Source](https://fly.io/docs/about/open-source/)
*   [Using Our Brand](https://fly.io/docs/about/brand/)
*   [Privacy Policy](https://fly.io/legal/privacy-policy/)
*   [Terms of Service](https://fly.io/legal/terms-of-service/)

--- title: Export logs layout: docs objective: Aggregate your logs to a service of your choice. nav: firecracker redirect_from: - /docs/going-to-production/monitoring/exporting-logs/ - /docs/metrics-and-logs/exporting-logs/ --- The Fly Log Shipper app enables you to aggregate your app's logs to a service of your choice. Your app's output to `stdout` become logs in Fly.io. Live log tail and log search are good enough for most things. But if you need to export your logs to an external service, such as Datadog or AWS S3, then you can use the Log Shipper. ## The Fly Log Shipper Here's the easiest way to ship your logs to a location of your choosing. The [Fly Log Shipper app](https://github.com/superfly/fly-log-shipper+external) hooks into Fly.io's internal log stream. You can run this in your Fly.io organization like any other app. The Fly Log Shipper runs [Vector](https://vector.dev/+external), which grabs the logs and sends them to a location of your choosing (via a Vector [sink](https://vector.dev/docs/reference/configuration/sinks/+external)). You can select one or more items from the list of supported [Providers (sinks)](https://github.com/superfly/fly-log-shipper#provider-configuration+external) and configure the Fly Log Shipper to run those sinks. Each provider just needs some environment variables (or secrets) set for them to work. ## Using the Fly Log Shipper Here's an example. To ship logs to [Logtail](https://betterstack.com/logtail+external), you would do the following: ```bash # Make a directory for your log shipper app mkdir logshippper cd logshippper # Create the app but don't deploy just yet fly launch --no-deploy --image ghcr.io/superfly/fly-log-shipper:latest # Set some secrets. The secret / env var you set # determines which "sinks" are configured ORG=personal fly secrets set ORG=$ORG fly secrets set ACCESS_TOKEN=$(fly tokens create readonly $ORG) fly secrets set LOGTAIL_TOKEN=<token provided by logtail source> ``` You can configure as many providers as you'd like by adding more secrets. The secrets needed are determined by [which provider(s)](https://github.com/superfly/fly-log-shipper#provider-configuration+external) you want to use. Before launching your application, you should edit the generated `fly.toml` file and delete the entire `[[services]]` section. Replace it with this: ```toml [[services]] http_checks = [] internal_port = 8686 ``` Then you can deploy it: ```cmd fly deploy ``` ## Shipping specific logs By default, the log shipper gets logs from every app running within your organization (organization is set by the `ORG` secret/environment variable). To narrow that down, you can set a [`SUBJECT`](https://github.com/superfly/fly-log-shipper#subject+external) environment variable in your instance of the Fly Log Shipper. That can be set as a secret, or as an environment variable in your `fly.toml` file. Subjects are in the format `logs.<app_name>.<region>.<instance_id>`. You can set the Log Shipper to narrow down to a specific instance, a specific region, and/or a specific application. There are [2 wildcards](https://docs.nats.io/nats-concepts/subjects#wildcards+external) you can use: * `*` wildcards go between strings and can be used multiple times * `>` wildcards go at the end of a string and can be used once For example, to only ship logs for an application named `sandwich`, you would set the `SUBJECT` environment variable like so (in your Log Shipper `fly.toml` file): ```toml [env] SUBJECT = "logs.sandwich.>" ``` This uses wildcard `>` to say to grab all logs from application `sandwich` no matter what region or instance they came from. Another example: ```toml [env] SUBJECT = "logs.*.dfw.>" ``` This `SUBJECT` says to grab logs from all instances of any applications hosted in the `dfw` region. ## Configuring Vector Based on your provider (or preferences), it may be necessary to customize the [Vector configuration](https://vector.dev/docs/reference/configuration/+external). This is done with a `vector.toml` configuration file and, thanks to [Machine files](/docs/reference/configuration/#the-files-section), it's as simple as copying the [source](https://github.com/superfly/fly-log-shipper/blob/3b780b3a3c68fdbbbb55430d7d9ff1eb377fdbf0/vector-configs/vector.toml+external) `vector.toml` to a local directory, modifying it according to your requirements, then saving it and redeploying: ```sh fly deploy --file-local="/etc/vector/vector.toml=/path/to/local/vector.toml" ``` That's it! The baked in config file is overwritten and Vector will use your modified config. ## Internals Fly.io ships logs through a [NATS](https://nats.io+external) stream. This is available to all of your apps via `nats://[fdaa::3]:4223`, which is where the Log Shipper grabs the logs. The Vector configuration to grab those logs within the Log Shipper is in the [vector.toml file](https://github.com/superfly/fly-log-shipper/blob/main/vector-configs/vector.toml+external). You can contribute to (or, you know, fork) this repository to add providers (sinks) of your own! ## Avoid duplicate log messages in high availability apps If you want to run more than one Machine for high availability, the [NATS](https://docs.nats.io/) endpoint supports [subscription queues](https://docs.nats.io/nats-concepts/core-nats/queue) to ensure messages are only sent to one subscriber of the named queue. The `QUEUE` secret can be set to configure an arbitrary queue name in your Log Shipper `fly.toml` file if you want to run multiple log processes for HA and avoid duplicate messages being shipped. For example: ```toml [env] QUEUE = "org-logs" ``` 

[Docs](https://fly.io/docs/)[Monitoring on Fly.io](https://fly.io/docs/monitoring)Export logs
Export logs
===========

The Fly Log Shipper app enables you to aggregate your app’s logs to a service of your choice.

Your app’s output to `stdout` become logs in Fly.io. Live log tail and log search are good enough for most things. But if you need to export your logs to an external service, such as Datadog or AWS S3, then you can use the Log Shipper.

[](https://fly.io/docs/monitoring/exporting-logs/#the-fly-log-shipper)The Fly Log Shipper
-----------------------------------------------------------------------------------------

Here’s the easiest way to ship your logs to a location of your choosing.

The [Fly Log Shipper app](https://github.com/superfly/fly-log-shipper) hooks into Fly.io’s internal log stream. You can run this in your Fly.io organization like any other app.

The Fly Log Shipper runs [Vector](https://vector.dev/), which grabs the logs and sends them to a location of your choosing (via a Vector [sink](https://vector.dev/docs/reference/configuration/sinks/)).

You can select one or more items from the list of supported [Providers (sinks)](https://github.com/superfly/fly-log-shipper#provider-configuration) and configure the Fly Log Shipper to run those sinks.

Each provider just needs some environment variables (or secrets) set for them to work.

[](https://fly.io/docs/monitoring/exporting-logs/#using-the-fly-log-shipper)Using the Fly Log Shipper
-----------------------------------------------------------------------------------------------------

Here’s an example. To ship logs to [Logtail](https://betterstack.com/logtail), you would do the following:

 Wrap text  Copy to clipboard 

```
# Make a directory for your log shipper app
mkdir logshippper
cd logshippper

# Create the app but don't deploy just yet
fly launch --no-deploy --image ghcr.io/superfly/fly-log-shipper:latest

# Set some secrets. The secret / env var you set
# determines which "sinks" are configured
ORG=personal
fly secrets set ORG=$ORG
fly secrets set ACCESS_TOKEN=$(fly tokens create readonly $ORG)
fly secrets set LOGTAIL_TOKEN=<token provided by logtail source>
```

You can configure as many providers as you’d like by adding more secrets. The secrets needed are determined by [which provider(s)](https://github.com/superfly/fly-log-shipper#provider-configuration) you want to use.

Before launching your application, you should edit the generated `fly.toml` file and delete the entire `[[services]]` section. Replace it with this:

 Wrap text  Copy to clipboard 

```
[[services]]
  http_checks = []
  internal_port = 8686
```

Then you can deploy it:

 Wrap text  Copy to clipboard 

```
fly deploy
```

[](https://fly.io/docs/monitoring/exporting-logs/#shipping-specific-logs)Shipping specific logs
-----------------------------------------------------------------------------------------------

By default, the log shipper gets logs from every app running within your organization (organization is set by the `ORG` secret/environment variable).

To narrow that down, you can set a [`SUBJECT`](https://github.com/superfly/fly-log-shipper#subject) environment variable in your instance of the Fly Log Shipper. That can be set as a secret, or as an environment variable in your `fly.toml` file.

Subjects are in the format `logs.<app_name>.<region>.<instance_id>`. You can set the Log Shipper to narrow down to a specific instance, a specific region, and/or a specific application.

There are [2 wildcards](https://docs.nats.io/nats-concepts/subjects#wildcards) you can use:

*   `*` wildcards go between strings and can be used multiple times 
*   `>` wildcards go at the end of a string and can be used once 

For example, to only ship logs for an application named `sandwich`, you would set the `SUBJECT` environment variable like so (in your Log Shipper `fly.toml` file):

 Wrap text  Copy to clipboard 

```
[env]
  SUBJECT = "logs.sandwich.>"
```

This uses wildcard `>` to say to grab all logs from application `sandwich` no matter what region or instance they came from.

Another example:

 Wrap text  Copy to clipboard 

```
[env]
  SUBJECT = "logs.*.dfw.>"
```

This `SUBJECT` says to grab logs from all instances of any applications hosted in the `dfw` region.

[](https://fly.io/docs/monitoring/exporting-logs/#configuring-vector)Configuring Vector
---------------------------------------------------------------------------------------

Based on your provider (or preferences), it may be necessary to customize the [Vector configuration](https://vector.dev/docs/reference/configuration/). This is done with a `vector.toml` configuration file and, thanks to [Machine files](https://fly.io/docs/reference/configuration/#the-files-section), it’s as simple as copying the [source](https://github.com/superfly/fly-log-shipper/blob/3b780b3a3c68fdbbbb55430d7d9ff1eb377fdbf0/vector-configs/vector.toml)`vector.toml` to a local directory, modifying it according to your requirements, then saving it and redeploying:

 Wrap text  Copy to clipboard 

```
fly deploy --file-local="/etc/vector/vector.toml=/path/to/local/vector.toml"
```

That’s it! The baked in config file is overwritten and Vector will use your modified config.

[](https://fly.io/docs/monitoring/exporting-logs/#internals)Internals
---------------------------------------------------------------------

Fly.io ships logs through a [NATS](https://nats.io/) stream. This is available to all of your apps via `nats://[fdaa::3]:4223`, which is where the Log Shipper grabs the logs.

The Vector configuration to grab those logs within the Log Shipper is in the [vector.toml file](https://github.com/superfly/fly-log-shipper/blob/main/vector-configs/vector.toml).

You can contribute to (or, you know, fork) this repository to add providers (sinks) of your own!

[](https://fly.io/docs/monitoring/exporting-logs/#avoid-duplicate-log-messages-in-high-availability-apps)Avoid duplicate log messages in high availability apps
---------------------------------------------------------------------------------------------------------------------------------------------------------------

If you want to run more than one Machine for high availability, the [NATS](https://docs.nats.io/) endpoint supports [subscription queues](https://docs.nats.io/nats-concepts/core-nats/queue) to ensure messages are only sent to one subscriber of the named queue. The `QUEUE` secret can be set to configure an arbitrary queue name in your Log Shipper `fly.toml` file if you want to run multiple log processes for HA and avoid duplicate messages being shipped. For example:

 Wrap text  Copy to clipboard 

```
[env]
  QUEUE = "org-logs"
```

Copy page as markdown or[Open in ChatGPT](https://chatgpt.com/?hints=search&q=Read+https%3A%2F%2Fraw.githubusercontent.com%2Fsuperfly%2Fdocs%2Fmain%2Fmonitoring%2Fexporting-logs.html.md)

[Report an issue](https://github.com/superfly/docs/issues/new?body=I+found+an+issue+with+this+document.%0A%0ATitle%3A+Export+logs%0ALocation%3A+https%3A%2F%2Ffly.io%2Fdocs%2Fmonitoring%2Fexporting-logs%2F%0ASource%3A+https%3A%2F%2Fgithub.com%2Fsuperfly%2Fdocs%2Fblob%2Fmain%2Fmonitoring%2Fexporting-logs.html.md%0A%0A%23%23%23+Describe+the+issue%0A%0A%3C%21--+Describe+the+issue+and+include+the+section+you%27re+referring+to%2C+if+applicable.+Provide+lots+of+detail+about+the+issue+that+you+found.++--%3E%0A%0A%23%23%23+Additional+info%0A%0A%3C%21--+Add+any+other+context+about+the+issue+here.+If+applicable%2C+add+screenshots+to+help+explain+the+issue.+--%3E%0A&title=Issue+with+the+%22Export+logs%22+doc) or [edit this page on GitHub](https://github.com/superfly/docs/edit/main/monitoring/exporting-logs.html.md)

[On this page](https://fly.io/docs/monitoring/exporting-logs/#)
*   [The Fly Log Shipper](https://fly.io/docs/monitoring/exporting-logs/#the-fly-log-shipper)
*   [Using the Fly Log Shipper](https://fly.io/docs/monitoring/exporting-logs/#using-the-fly-log-shipper)
*   [Shipping specific logs](https://fly.io/docs/monitoring/exporting-logs/#shipping-specific-logs)
*   [Configuring Vector](https://fly.io/docs/monitoring/exporting-logs/#configuring-vector)
*   [Internals](https://fly.io/docs/monitoring/exporting-logs/#internals)
*   [Avoid duplicate log messages in high availability apps](https://fly.io/docs/monitoring/exporting-logs/#avoid-duplicate-log-messages-in-high-availability-apps)

Copy page as markdown[Open in ChatGPT](https://chatgpt.com/?hints=search&q=Read+https%3A%2F%2Fraw.githubusercontent.com%2Fsuperfly%2Fdocs%2Fmain%2Fmonitoring%2Fexporting-logs.html.md)
