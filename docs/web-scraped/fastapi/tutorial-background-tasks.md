# Source: https://fastapi.tiangolo.com/tutorial/background-tasks/

Title: Background Tasks - FastAPI

URL Source: https://fastapi.tiangolo.com/tutorial/background-tasks/

Markdown Content:
Background Tasks - FastAPI
===============
- [x] - [x] 

[Skip to content](https://fastapi.tiangolo.com/tutorial/background-tasks/#background-tasks)

[Join the **FastAPI Cloud** waiting list üöÄ](https://fastapicloud.com/)

[Follow **@fastapi** on **X (Twitter)** to stay updated](https://x.com/fastapi)

[Follow **FastAPI** on **LinkedIn** to stay updated](https://www.linkedin.com/company/fastapi)

[Subscribe to the **FastAPI and friends** newsletter üéâ](https://fastapi.tiangolo.com/newsletter/)

[sponsor![Image 1](https://fastapi.tiangolo.com/img/sponsors/blockbee-banner.png)](https://blockbee.io/?ref=fastapi "BlockBee Cryptocurrency Payment Gateway")

[sponsor![Image 2](https://fastapi.tiangolo.com/img/sponsors/scalar-banner.svg)](https://github.com/scalar/scalar/?utm_source=fastapi&utm_medium=website&utm_campaign=top-banner "Scalar: Beautiful Open-Source API References from Swagger/OpenAPI files")

[sponsor![Image 3](https://fastapi.tiangolo.com/img/sponsors/propelauth-banner.png)](https://www.propelauth.com/?utm_source=fastapi&utm_campaign=1223&utm_medium=topbanner "Auth, user management and more for your B2B product")

[sponsor![Image 4](https://fastapi.tiangolo.com/img/sponsors/zuplo-banner.png)](https://zuplo.link/fastapi-web "Zuplo: Scale, Protect, Document, and Monetize your FastAPI")

[sponsor![Image 5](https://fastapi.tiangolo.com/img/sponsors/liblab-banner.png)](https://liblab.com/?utm_source=fastapi "liblab - Generate SDKs from FastAPI")

[sponsor![Image 6](https://fastapi.tiangolo.com/img/sponsors/render-banner.svg)](https://docs.render.com/deploy-fastapi?utm_source=deploydoc&utm_medium=referral&utm_campaign=fastapi "Deploy & scale any full-stack web app on Render. Focus on building apps, not infra.")

[sponsor![Image 7](https://fastapi.tiangolo.com/img/sponsors/coderabbit-banner.png)](https://www.coderabbit.ai/?utm_source=fastapi&utm_medium=banner&utm_campaign=fastapi "Cut Code Review Time & Bugs in Half with CodeRabbit")

[sponsor![Image 8](https://fastapi.tiangolo.com/img/sponsors/subtotal-banner.svg)](https://subtotal.com/?utm_source=fastapi&utm_medium=sponsorship&utm_campaign=open-source "Making Retail Purchases Actionable for Brands and Developers")

[sponsor![Image 9](https://fastapi.tiangolo.com/img/sponsors/railway-banner.png)](https://docs.railway.com/guides/fastapi?utm_medium=integration&utm_source=docs&utm_campaign=fastapi "Deploy enterprise applications at startup speed")

[sponsor![Image 10](https://fastapi.tiangolo.com/img/sponsors/serpapi-banner.png)](https://serpapi.com/?utm_source=fastapi_website "SerpApi: Web Search API")

[sponsor![Image 11](https://fastapi.tiangolo.com/img/sponsors/greptile-banner.png)](https://www.greptile.com/?utm_source=fastapi&utm_medium=sponsorship&utm_campaign=fastapi_sponsor_page "Greptile: The AI Code Reviewer")

[![Image 12: logo](https://fastapi.tiangolo.com/img/icon-white.svg)](https://fastapi.tiangolo.com/ "FastAPI")

 FastAPI 

 Background Tasks 

*   [en - English](https://fastapi.tiangolo.com/)
*   [de - Deutsch](https://fastapi.tiangolo.com/de/)
*   [es - espa√±ol](https://fastapi.tiangolo.com/es/)
*   [fr - fran√ßais](https://fastapi.tiangolo.com/fr/)
*   [ja - Êó•Êú¨Ë™û](https://fastapi.tiangolo.com/ja/)
*   [ko - ÌïúÍµ≠Ïñ¥](https://fastapi.tiangolo.com/ko/)
*   [pt - portugu√™s](https://fastapi.tiangolo.com/pt/)
*   [ru - —Ä—É—Å—Å–∫–∏–π —è–∑—ã–∫](https://fastapi.tiangolo.com/ru/)
*   [tr - T√ºrk√ße](https://fastapi.tiangolo.com/tr/)
*   [uk - —É–∫—Ä–∞—ó–Ω—Å—å–∫–∞ –º–æ–≤–∞](https://fastapi.tiangolo.com/uk/)
*   [zh - ÁÆÄ‰Ωì‰∏≠Êñá](https://fastapi.tiangolo.com/zh/)
*   [zh-hant - ÁπÅÈ´î‰∏≠Êñá](https://fastapi.tiangolo.com/zh-hant/)

[](javascript:void(0) "Share")

 Initializing search 

[fastapi/fastapi](https://github.com/fastapi/fastapi "Go to repository")

*   [FastAPI](https://fastapi.tiangolo.com/)
*   [Features](https://fastapi.tiangolo.com/features/)
*   [Learn](https://fastapi.tiangolo.com/learn/)
*   [Reference](https://fastapi.tiangolo.com/reference/)
*   [FastAPI People](https://fastapi.tiangolo.com/fastapi-people/)
*   [Resources](https://fastapi.tiangolo.com/resources/)
*   [About](https://fastapi.tiangolo.com/about/)
*   [Release Notes](https://fastapi.tiangolo.com/release-notes/)

[![Image 13: logo](https://fastapi.tiangolo.com/img/icon-white.svg)](https://fastapi.tiangolo.com/ "FastAPI") FastAPI  

[fastapi/fastapi](https://github.com/fastapi/fastapi "Go to repository")

*   [FastAPI](https://fastapi.tiangolo.com/)
*   [Features](https://fastapi.tiangolo.com/features/)
*   - [x] [Learn](https://fastapi.tiangolo.com/learn/)  Learn  
    *   [Python Types Intro](https://fastapi.tiangolo.com/python-types/)
    *   [Concurrency and async / await](https://fastapi.tiangolo.com/async/)
    *   [Environment Variables](https://fastapi.tiangolo.com/environment-variables/)
    *   [Virtual Environments](https://fastapi.tiangolo.com/virtual-environments/)
    *   - [x] [Tutorial - User Guide](https://fastapi.tiangolo.com/tutorial/)  Tutorial - User Guide  
        *   [First Steps](https://fastapi.tiangolo.com/tutorial/first-steps/)
        *   [Path Parameters](https://fastapi.tiangolo.com/tutorial/path-params/)
        *   [Query Parameters](https://fastapi.tiangolo.com/tutorial/query-params/)
        *   [Request Body](https://fastapi.tiangolo.com/tutorial/body/)
        *   [Query Parameters and String Validations](https://fastapi.tiangolo.com/tutorial/query-params-str-validations/)
        *   [Path Parameters and Numeric Validations](https://fastapi.tiangolo.com/tutorial/path-params-numeric-validations/)
        *   [Query Parameter Models](https://fastapi.tiangolo.com/tutorial/query-param-models/)
        *   [Body - Multiple Parameters](https://fastapi.tiangolo.com/tutorial/body-multiple-params/)
        *   [Body - Fields](https://fastapi.tiangolo.com/tutorial/body-fields/)
        *   [Body - Nested Models](https://fastapi.tiangolo.com/tutorial/body-nested-models/)
        *   [Declare Request Example Data](https://fastapi.tiangolo.com/tutorial/schema-extra-example/)
        *   [Extra Data Types](https://fastapi.tiangolo.com/tutorial/extra-data-types/)
        *   [Cookie Parameters](https://fastapi.tiangolo.com/tutorial/cookie-params/)
        *   [Header Parameters](https://fastapi.tiangolo.com/tutorial/header-params/)
        *   [Cookie Parameter Models](https://fastapi.tiangolo.com/tutorial/cookie-param-models/)
        *   [Header Parameter Models](https://fastapi.tiangolo.com/tutorial/header-param-models/)
        *   [Response Model - Return Type](https://fastapi.tiangolo.com/tutorial/response-model/)
        *   [Extra Models](https://fastapi.tiangolo.com/tutorial/extra-models/)
        *   [Response Status Code](https://fastapi.tiangolo.com/tutorial/response-status-code/)
        *   [Form Data](https://fastapi.tiangolo.com/tutorial/request-forms/)
        *   [Form Models](https://fastapi.tiangolo.com/tutorial/request-form-models/)
        *   [Request Files](https://fastapi.tiangolo.com/tutorial/request-files/)
        *   [Request Forms and Files](https://fastapi.tiangolo.com/tutorial/request-forms-and-files/)
        *   [Handling Errors](https://fastapi.tiangolo.com/tutorial/handling-errors/)
        *   [Path Operation Configuration](https://fastapi.tiangolo.com/tutorial/path-operation-configuration/)
        *   [JSON Compatible Encoder](https://fastapi.tiangolo.com/tutorial/encoder/)
        *   [Body - Updates](https://fastapi.tiangolo.com/tutorial/body-updates/)
        *   - [x] [Dependencies](https://fastapi.tiangolo.com/tutorial/dependencies/)  Dependencies  
            *   [Classes as Dependencies](https://fastapi.tiangolo.com/tutorial/dependencies/classes-as-dependencies/)
            *   [Sub-dependencies](https://fastapi.tiangolo.com/tutorial/dependencies/sub-dependencies/)
            *   [Dependencies in path operation decorators](https://fastapi.tiangolo.com/tutorial/dependencies/dependencies-in-path-operation-decorators/)
            *   [Global Dependencies](https://fastapi.tiangolo.com/tutorial/dependencies/global-dependencies/)
            *   [Dependencies with yield](https://fastapi.tiangolo.com/tutorial/dependencies/dependencies-with-yield/)

        *   - [x] [Security](https://fastapi.tiangolo.com/tutorial/security/)  Security  
            *   [Security - First Steps](https://fastapi.tiangolo.com/tutorial/security/first-steps/)
            *   [Get Current User](https://fastapi.tiangolo.com/tutorial/security/get-current-user/)
            *   [Simple OAuth2 with Password and Bearer](https://fastapi.tiangolo.com/tutorial/security/simple-oauth2/)
            *   [OAuth2 with Password (and hashing), Bearer with JWT tokens](https://fastapi.tiangolo.com/tutorial/security/oauth2-jwt/)

        *   [Middleware](https://fastapi.tiangolo.com/tutorial/middleware/)
        *   [CORS (Cross-Origin Resource Sharing)](https://fastapi.tiangolo.com/tutorial/cors/)
        *   [SQL (Relational) Databases](https://fastapi.tiangolo.com/tutorial/sql-databases/)
        *   [Bigger Applications - Multiple Files](https://fastapi.tiangolo.com/tutorial/bigger-applications/)
        *   [Stream JSON Lines](https://fastapi.tiangolo.com/tutorial/stream-json-lines/)
        *   [Server-Sent Events (SSE)](https://fastapi.tiangolo.com/tutorial/server-sent-events/)
        *   - [x]  Background Tasks  [Background Tasks](https://fastapi.tiangolo.com/tutorial/background-tasks/) Table of contents  
            *   [Using `BackgroundTasks`](https://fastapi.tiangolo.com/tutorial/background-tasks/#using-backgroundtasks)
            *   [Create a task function](https://fastapi.tiangolo.com/tutorial/background-tasks/#create-a-task-function)
            *   [Add the background task](https://fastapi.tiangolo.com/tutorial/background-tasks/#add-the-background-task)
            *   [Dependency Injection](https://fastapi.tiangolo.com/tutorial/background-tasks/#dependency-injection)
            *   [Technical Details](https://fastapi.tiangolo.com/tutorial/background-tasks/#technical-details)
            *   [Caveat](https://fastapi.tiangolo.com/tutorial/background-tasks/#caveat)
            *   [Recap](https://fastapi.tiangolo.com/tutorial/background-tasks/#recap)

        *   [Metadata and Docs URLs](https://fastapi.tiangolo.com/tutorial/metadata/)
        *   [Static Files](https://fastapi.tiangolo.com/tutorial/static-files/)
        *   [Testing](https://fastapi.tiangolo.com/tutorial/testing/)
        *   [Debugging](https://fastapi.tiangolo.com/tutorial/debugging/)

    *   - [x] [Advanced User Guide](https://fastapi.tiangolo.com/advanced/)  Advanced User Guide  
        *   [Stream Data](https://fastapi.tiangolo.com/advanced/stream-data/)
        *   [Path Operation Advanced Configuration](https://fastapi.tiangolo.com/advanced/path-operation-advanced-configuration/)
        *   [Additional Status Codes](https://fastapi.tiangolo.com/advanced/additional-status-codes/)
        *   [Return a Response Directly](https://fastapi.tiangolo.com/advanced/response-directly/)
        *   [Custom Response - HTML, Stream, File, others](https://fastapi.tiangolo.com/advanced/custom-response/)
        *   [Additional Responses in OpenAPI](https://fastapi.tiangolo.com/advanced/additional-responses/)
        *   [Response Cookies](https://fastapi.tiangolo.com/advanced/response-cookies/)
        *   [Response Headers](https://fastapi.tiangolo.com/advanced/response-headers/)
        *   [Response - Change Status Code](https://fastapi.tiangolo.com/advanced/response-change-status-code/)
        *   [Advanced Dependencies](https://fastapi.tiangolo.com/advanced/advanced-dependencies/)
        *   - [x] [Advanced Security](https://fastapi.tiangolo.com/advanced/security/)  Advanced Security  
            *   [OAuth2 scopes](https://fastapi.tiangolo.com/advanced/security/oauth2-scopes/)
            *   [HTTP Basic Auth](https://fastapi.tiangolo.com/advanced/security/http-basic-auth/)

        *   [Using the Request Directly](https://fastapi.tiangolo.com/advanced/using-request-directly/)
        *   [Using Dataclasses](https://fastapi.tiangolo.com/advanced/dataclasses/)
        *   [Advanced Middleware](https://fastapi.tiangolo.com/advanced/middleware/)
        *   [Sub Applications - Mounts](https://fastapi.tiangolo.com/advanced/sub-applications/)
        *   [Behind a Proxy](https://fastapi.tiangolo.com/advanced/behind-a-proxy/)
        *   [Templates](https://fastapi.tiangolo.com/advanced/templates/)
        *   [WebSockets](https://fastapi.tiangolo.com/advanced/websockets/)
        *   [Lifespan Events](https://fastapi.tiangolo.com/advanced/events/)
        *   [Testing WebSockets](https://fastapi.tiangolo.com/advanced/testing-websockets/)
        *   [Testing Events: lifespan and startup - shutdown](https://fastapi.tiangolo.com/advanced/testing-events/)
        *   [Testing Dependencies with Overrides](https://fastapi.tiangolo.com/advanced/testing-dependencies/)
        *   [Async Tests](https://fastapi.tiangolo.com/advanced/async-tests/)
        *   [Settings and Environment Variables](https://fastapi.tiangolo.com/advanced/settings/)
        *   [OpenAPI Callbacks](https://fastapi.tiangolo.com/advanced/openapi-callbacks/)
        *   [OpenAPI Webhooks](https://fastapi.tiangolo.com/advanced/openapi-webhooks/)
        *   [Including WSGI - Flask, Django, others](https://fastapi.tiangolo.com/advanced/wsgi/)
        *   [Generating SDKs](https://fastapi.tiangolo.com/advanced/generate-clients/)
        *   [Advanced Python Types](https://fastapi.tiangolo.com/advanced/advanced-python-types/)
        *   [JSON with Bytes as Base64](https://fastapi.tiangolo.com/advanced/json-base64-bytes/)
        *   [Strict Content-Type Checking](https://fastapi.tiangolo.com/advanced/strict-content-type/)

    *   [FastAPI CLI](https://fastapi.tiangolo.com/fastapi-cli/)
    *   - [x] [Deployment](https://fastapi.tiangolo.com/deployment/)  Deployment  
        *   [About FastAPI versions](https://fastapi.tiangolo.com/deployment/versions/)
        *   [FastAPI Cloud](https://fastapi.tiangolo.com/deployment/fastapicloud/)
        *   [About HTTPS](https://fastapi.tiangolo.com/deployment/https/)
        *   [Run a Server Manually](https://fastapi.tiangolo.com/deployment/manually/)
        *   [Deployments Concepts](https://fastapi.tiangolo.com/deployment/concepts/)
        *   [Deploy FastAPI on Cloud Providers](https://fastapi.tiangolo.com/deployment/cloud/)
        *   [Server Workers - Uvicorn with Workers](https://fastapi.tiangolo.com/deployment/server-workers/)
        *   [FastAPI in Containers - Docker](https://fastapi.tiangolo.com/deployment/docker/)

    *   - [x] [How To - Recipes](https://fastapi.tiangolo.com/how-to/)  How To - Recipes  
        *   [General - How To - Recipes](https://fastapi.tiangolo.com/how-to/general/)
        *   [Migrate from Pydantic v1 to Pydantic v2](https://fastapi.tiangolo.com/how-to/migrate-from-pydantic-v1-to-pydantic-v2/)
        *   [GraphQL](https://fastapi.tiangolo.com/how-to/graphql/)
        *   [Custom Request and APIRoute class](https://fastapi.tiangolo.com/how-to/custom-request-and-route/)
        *   [Conditional OpenAPI](https://fastapi.tiangolo.com/how-to/conditional-openapi/)
        *   [Extending OpenAPI](https://fastapi.tiangolo.com/how-to/extending-openapi/)
        *   [Separate OpenAPI Schemas for Input and Output or Not](https://fastapi.tiangolo.com/how-to/separate-openapi-schemas/)
        *   [Custom Docs UI Static Assets (Self-Hosting)](https://fastapi.tiangolo.com/how-to/custom-docs-ui-assets/)
        *   [Configure Swagger UI](https://fastapi.tiangolo.com/how-to/configure-swagger-ui/)
        *   [Testing a Database](https://fastapi.tiangolo.com/how-to/testing-database/)
        *   [Use Old 403 Authentication Error Status Codes](https://fastapi.tiangolo.com/how-to/authentication-error-status-code/)

*   - [x] [Reference](https://fastapi.tiangolo.com/reference/)  Reference  
    *   [`FastAPI` class](https://fastapi.tiangolo.com/reference/fastapi/)
    *   [Request Parameters](https://fastapi.tiangolo.com/reference/parameters/)
    *   [Status Codes](https://fastapi.tiangolo.com/reference/status/)
    *   [`UploadFile` class](https://fastapi.tiangolo.com/reference/uploadfile/)
    *   [Exceptions - `HTTPException` and `WebSocketException`](https://fastapi.tiangolo.com/reference/exceptions/)
    *   [Dependencies - `Depends()` and `Security()`](https://fastapi.tiangolo.com/reference/dependencies/)
    *   [`APIRouter` class](https://fastapi.tiangolo.com/reference/apirouter/)
    *   [Background Tasks - `BackgroundTasks`](https://fastapi.tiangolo.com/reference/background/)
    *   [`Request` class](https://fastapi.tiangolo.com/reference/request/)
    *   [WebSockets](https://fastapi.tiangolo.com/reference/websockets/)
    *   [`HTTPConnection` class](https://fastapi.tiangolo.com/reference/httpconnection/)
    *   [`Response` class](https://fastapi.tiangolo.com/reference/response/)
    *   [Custom Response Classes - File, HTML, Redirect, Streaming, etc.](https://fastapi.tiangolo.com/reference/responses/)
    *   [Middleware](https://fastapi.tiangolo.com/reference/middleware/)
    *   - [x] [OpenAPI](https://fastapi.tiangolo.com/reference/openapi/)  OpenAPI  
        *   [OpenAPI `docs`](https://fastapi.tiangolo.com/reference/openapi/docs/)
        *   [OpenAPI `models`](https://fastapi.tiangolo.com/reference/openapi/models/)

    *   [Security Tools](https://fastapi.tiangolo.com/reference/security/)
    *   [Encoders - `jsonable_encoder`](https://fastapi.tiangolo.com/reference/encoders/)
    *   [Static Files - `StaticFiles`](https://fastapi.tiangolo.com/reference/staticfiles/)
    *   [Templating - `Jinja2Templates`](https://fastapi.tiangolo.com/reference/templating/)
    *   [Test Client - `TestClient`](https://fastapi.tiangolo.com/reference/testclient/)

*   [FastAPI People](https://fastapi.tiangolo.com/fastapi-people/)
*   - [x] [Resources](https://fastapi.tiangolo.com/resources/)  Resources  
    *   [Help FastAPI - Get Help](https://fastapi.tiangolo.com/help-fastapi/)
    *   [Development - Contributing](https://fastapi.tiangolo.com/contributing/)
    *   [Full Stack FastAPI Template](https://fastapi.tiangolo.com/project-generation/)
    *   [External Links](https://fastapi.tiangolo.com/external-links/)
    *   [FastAPI and friends newsletter](https://fastapi.tiangolo.com/newsletter/)
    *   [Repository Management Tasks](https://fastapi.tiangolo.com/management-tasks/)

*   - [x] [About](https://fastapi.tiangolo.com/about/)  About  
    *   [Alternatives, Inspiration and Comparisons](https://fastapi.tiangolo.com/alternatives/)
    *   [History, Design and Future](https://fastapi.tiangolo.com/history-design-future/)
    *   [Benchmarks](https://fastapi.tiangolo.com/benchmarks/)
    *   [Repository Management](https://fastapi.tiangolo.com/management/)

*   [Release Notes](https://fastapi.tiangolo.com/release-notes/)

 Table of contents  
*   [Using `BackgroundTasks`](https://fastapi.tiangolo.com/tutorial/background-tasks/#using-backgroundtasks)
*   [Create a task function](https://fastapi.tiangolo.com/tutorial/background-tasks/#create-a-task-function)
*   [Add the background task](https://fastapi.tiangolo.com/tutorial/background-tasks/#add-the-background-task)
*   [Dependency Injection](https://fastapi.tiangolo.com/tutorial/background-tasks/#dependency-injection)
*   [Technical Details](https://fastapi.tiangolo.com/tutorial/background-tasks/#technical-details)
*   [Caveat](https://fastapi.tiangolo.com/tutorial/background-tasks/#caveat)
*   [Recap](https://fastapi.tiangolo.com/tutorial/background-tasks/#recap)

1.   [FastAPI](https://fastapi.tiangolo.com/)
2.   [Learn](https://fastapi.tiangolo.com/learn/)
3.   [Tutorial - User Guide](https://fastapi.tiangolo.com/tutorial/)

Background Tasks[¬∂](https://fastapi.tiangolo.com/tutorial/background-tasks/#background-tasks "Permanent link")
==============================================================================================================

You can define background tasks to be run _after_ returning a response.

This is useful for operations that need to happen after a request, but that the client doesn't really have to be waiting for the operation to complete before receiving the response.

This includes, for example:

*   Email notifications sent after performing an action:
    *   As connecting to an email server and sending an email tends to be "slow" (several seconds), you can return the response right away and send the email notification in the background.

*   Processing data:
    *   For example, let's say you receive a file that must go through a slow process, you can return a response of "Accepted" (HTTP 202) and process the file in the background.

Using `BackgroundTasks`[¬∂](https://fastapi.tiangolo.com/tutorial/background-tasks/#using-backgroundtasks "Permanent link")
--------------------------------------------------------------------------------------------------------------------------

First, import `BackgroundTasks` and define a parameter in your _path operation function_ with a type declaration of `BackgroundTasks`:

Python 3.10+ 

```
from fastapi import BackgroundTasks, FastAPI

app = FastAPI()

def write_notification(email: str, message=""):
    with open("log.txt", mode="w") as email_file:
        content = f"notification for {email}: {message}"
        email_file.write(content)

@app.post("/send-notification/{email}")
async def send_notification(email: str, background_tasks: BackgroundTasks):
    background_tasks.add_task(write_notification, email, message="some notification")
    return {"message": "Notification sent in the background"}
```

**FastAPI** will create the object of type `BackgroundTasks` for you and pass it as that parameter.

Create a task function[¬∂](https://fastapi.tiangolo.com/tutorial/background-tasks/#create-a-task-function "Permanent link")
--------------------------------------------------------------------------------------------------------------------------

Create a function to be run as the background task.

It is just a standard function that can receive parameters.

It can be an `async def` or normal `def` function, **FastAPI** will know how to handle it correctly.

In this case, the task function will write to a file (simulating sending an email).

And as the write operation doesn't use `async` and `await`, we define the function with normal `def`:

Python 3.10+ 

```
from fastapi import BackgroundTasks, FastAPI

app = FastAPI()

def write_notification(email: str, message=""):
    with open("log.txt", mode="w") as email_file:
        content = f"notification for {email}: {message}"
        email_file.write(content)

@app.post("/send-notification/{email}")
async def send_notification(email: str, background_tasks: BackgroundTasks):
    background_tasks.add_task(write_notification, email, message="some notification")
    return {"message": "Notification sent in the background"}
```

Add the background task[¬∂](https://fastapi.tiangolo.com/tutorial/background-tasks/#add-the-background-task "Permanent link")
----------------------------------------------------------------------------------------------------------------------------

Inside of your _path operation function_, pass your task function to the _background tasks_ object with the method `.add_task()`:

Python 3.10+ 

```
from fastapi import BackgroundTasks, FastAPI

app = FastAPI()

def write_notification(email: str, message=""):
    with open("log.txt", mode="w") as email_file:
        content = f"notification for {email}: {message}"
        email_file.write(content)

@app.post("/send-notification/{email}")
async def send_notification(email: str, background_tasks: BackgroundTasks):
    background_tasks.add_task(write_notification, email, message="some notification")
    return {"message": "Notification sent in the background"}
```

`.add_task()` receives as arguments:

*   A task function to be run in the background (`write_notification`).
*   Any sequence of arguments that should be passed to the task function in order (`email`).
*   Any keyword arguments that should be passed to the task function (`message="some notification"`).

Dependency Injection[¬∂](https://fastapi.tiangolo.com/tutorial/background-tasks/#dependency-injection "Permanent link")
----------------------------------------------------------------------------------------------------------------------

Using `BackgroundTasks` also works with the dependency injection system, you can declare a parameter of type `BackgroundTasks` at multiple levels: in a _path operation function_, in a dependency (dependable), in a sub-dependency, etc.

**FastAPI** knows what to do in each case and how to reuse the same object, so that all the background tasks are merged together and are run in the background afterwards:

Python 3.10+ 

```
from typing import Annotated

from fastapi import BackgroundTasks, Depends, FastAPI

app = FastAPI()

def write_log(message: str):
    with open("log.txt", mode="a") as log:
        log.write(message)

def get_query(background_tasks: BackgroundTasks, q: str | None = None):
    if q:
        message = f"found query: {q}\n"
        background_tasks.add_task(write_log, message)
    return q

@app.post("/send-notification/{email}")
async def send_notification(
    email: str, background_tasks: BackgroundTasks, q: Annotated[str, Depends(get_query)]
):
    message = f"message to {email}\n"
    background_tasks.add_task(write_log, message)
    return {"message": "Message sent"}
```

ü§ì Other versions and variants

Python 3.10+ - non-Annotated 

Tip

Prefer to use the `Annotated` version if possible.

```
from fastapi import BackgroundTasks, Depends, FastAPI

app = FastAPI()

def write_log(message: str):
    with open("log.txt", mode="a") as log:
        log.write(message)

def get_query(background_tasks: BackgroundTasks, q: str | None = None):
    if q:
        message = f"found query: {q}\n"
        background_tasks.add_task(write_log, message)
    return q

@app.post("/send-notification/{email}")
async def send_notification(
    email: str, background_tasks: BackgroundTasks, q: str = Depends(get_query)
):
    message = f"message to {email}\n"
    background_tasks.add_task(write_log, message)
    return {"message": "Message sent"}
```

In this example, the messages will be written to the `log.txt` file _after_ the response is sent.

If there was a query in the request, it will be written to the log in a background task.

And then another background task generated at the _path operation function_ will write a message using the `email` path parameter.

Technical Details[¬∂](https://fastapi.tiangolo.com/tutorial/background-tasks/#technical-details "Permanent link")
----------------------------------------------------------------------------------------------------------------

The class `BackgroundTasks` comes directly from [`starlette.background`](https://www.starlette.dev/background/).

It is imported/included directly into FastAPI so that you can import it from `fastapi` and avoid accidentally importing the alternative `BackgroundTask` (without the `s` at the end) from `starlette.background`.

By only using `BackgroundTasks` (and not `BackgroundTask`), it's then possible to use it as a _path operation function_ parameter and have **FastAPI** handle the rest for you, just like when using the `Request` object directly.

It's still possible to use `BackgroundTask` alone in FastAPI, but you have to create the object in your code and return a Starlette `Response` including it.

You can see more details in [Starlette's official docs for Background Tasks](https://www.starlette.dev/background/).

Caveat[¬∂](https://fastapi.tiangolo.com/tutorial/background-tasks/#caveat "Permanent link")
------------------------------------------------------------------------------------------

If you need to perform heavy background computation and you don't necessarily need it to be run by the same process (for example, you don't need to share memory, variables, etc), you might benefit from using other bigger tools like [Celery](https://docs.celeryq.dev/).

They tend to require more complex configurations, a message/job queue manager, like RabbitMQ or Redis, but they allow you to run background tasks in multiple processes, and especially, in multiple servers.

But if you need to access variables and objects from the same **FastAPI** app, or you need to perform small background tasks (like sending an email notification), you can simply just use `BackgroundTasks`.

Recap[¬∂](https://fastapi.tiangolo.com/tutorial/background-tasks/#recap "Permanent link")
----------------------------------------------------------------------------------------

Import and use `BackgroundTasks` with parameters in _path operation functions_ and dependencies to add background tasks.

 Back to top [Previous Server-Sent Events (SSE)](https://fastapi.tiangolo.com/tutorial/server-sent-events/)[Next Metadata and Docs URLs](https://fastapi.tiangolo.com/tutorial/metadata/)

 The FastAPI trademark is owned by [@tiangolo](https://tiangolo.com/) and is registered in the US and across other regions 

 Made with [Material for MkDocs](https://squidfunk.github.io/mkdocs-material/)

[](https://github.com/fastapi/fastapi "github.com")[](https://discord.gg/VQjSZaeJmf "discord.gg")[](https://x.com/fastapi "x.com")[](https://www.linkedin.com/company/fastapi "www.linkedin.com")[](https://tiangolo.com/ "tiangolo.com")
