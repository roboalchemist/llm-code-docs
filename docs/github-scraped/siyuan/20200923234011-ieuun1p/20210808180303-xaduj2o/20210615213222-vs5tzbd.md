<!-- Source: https://github.com/siyuan-note/user-guide-en_US/blob/master/20200923234011-ieuun1p/20210808180303-xaduj2o/20210615213222-vs5tzbd.sy -->

# Data history

## Overview

Data history is mainly used to ensure data security, and even if a misoperation occurs, data can be rolled back through the history. Historical data is uniformly stored in the `workspace/history/` folder. History will be automatically generated in the following cases:

- Every 10 minutes, a history will be generated for the documents updated within these 10 minutes. The interval can be set by <kbd>Settings</kbd> - <kbd>Editor</kbd> - <kbd>History Generation Interval</kbd> make adjustments, and the suffix of the history folder is `-update`
- When synchronizing in the cloud, the local data covered by the cloud will generate a history, and the suffix of the history folder is `-sync`
- History will be generated when manually deleting notebooks, documents and assets, and the suffix of the history folder is `-delete`
- When using Cleanup unreferenced assets, a history will be generated, and the suffix of the history folder is `-delete`
- When using the `Insert a space between Chinese and Western` function, a history will be generated, and the suffix of the history folder is `-format`

## Browsing History

- At the top <kbd>...</kbd> menu or <kbd>Alt+H</kbd> to open the history, only supports browsing the latest 32 times of history
- Browse under the filesystem `workspace/history/` folder

## Rollback

In the time list column on the left side of the history interface, there is a rollback button behind each historical record. After clicking, a confirmation dialog box will pop up. If the rollback is confirmed, the existing data will be overwritten with the historical data.

If there are very many files that need to be rolled back, it is recommended to manually copy on the file system. The internal structure of the history folder is the same as the internal structure of data, for example:

- Notebook delete: `2022-05-01-091021-delete/20210808180117-czj9bvb/`, i.e. `historical generation date-{operation}/{notebook ID}/`
- Document deletion: `2022-05-01-091209-delete/20210808180117-czj9bvb/20200812220555-lj3enxa.sy`, which is `historical generation date-{operation}/{notebook ID}/{document path}`
- Asset file deletion: `2022-05-01-095621-delete/assets/image-20220501091157-qccp87e.png`, which is `historical generation date-{operation}/assets/{asset file name}`

Manual rollback steps:

1. Exit SiYuan, and then make a full copy and backup of the entire workspace to avoid data loss caused by subsequent misoperations
2. Go to the `workspace/history/` folder and copy the data in the `historical generation date-{operation}` folder directly to the data folder for overwriting
3. Restart SiYuan
