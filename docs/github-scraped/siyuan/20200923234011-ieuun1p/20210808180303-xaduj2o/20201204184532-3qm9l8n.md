<!-- Source: https://github.com/siyuan-note/user-guide-en_US/blob/master/20200923234011-ieuun1p/20210808180303-xaduj2o/20201204184532-3qm9l8n.sy -->

# Template snippet

## Overview

The template snippet is used to quickly insert the previously set text content at the cursor caret position, and it supports variables. Template snippets use `.md` suffix files and are stored in the data/templates folder of the workspace.

## Writing a template

The template is implemented using [The Go Programming Language text template](https://golang.org/pkg/text/template/). If you have an understanding of this, you can implement some program logic in it, such as comparison logic , Iterative logic, etc. In addition, to avoid syntax conflicts, template syntax uses `.action{action}` (instead of `{{action}}`).

We have built-in variables and functions to enrich the template through the open source project [Sprig](https://github.com/Masterminds/sprig). For example, you can use `.action{now | date "2006-01-02 15:04:05"}` to render the current time. For more usage, please refer to [Sprig Function Documentation](http://masterminds.github.io/sprig/).

There is a detail about the date and time formatting. Note: The formatting of the Go programming language is quite special: Instead of using `yyyy-MM-dd HH:mm:ss`, use `2006-01-02 15:04: 05` This fixed time format ([related discussions on Stack Overflow](https://stackoverflow.com/questions/20530327/origin-of-mon-jan-2-150405-mst-2006-in-golang)).

In addition to the built-in variables and functions of Sprig, the following variables and functions are also supported:

- `title`: Use this variable to insert the current document name. For example, if the template content is `# .action{.title}`, it will be inserted into the current document content with the first-level heading syntax after invoking
- `id`：Use this variable to insert the current document id
- `name`: Use this variable to insert the current document name
- `alias`：Use this variable to insert the current document alias
- `queryBlocks`: This function is used to query the database, and the return value is a list of blocks,  and the parameter is a SQL statement: `.action{sql "SELECT * FROM blocks LIMIT 7"}`
- `querySpans`: This function is used to query the database, and the return value is a list of spans,  and the parameter is a SQL statement: `.action{sql "SELECT * FROM spans LIMIT 7"}`
- `parseTime`: This function is used to parse a string in time format into a `time.Time` type so that more formatting methods can be used to render the time

`queryBlocks` and `querySpans` support variable parameter lists similar to SQL prepared statements to facilitate the input of parameters:

```
.action{$today := now | date "20060102150405"}
.action{$blocks :=queryBlocks "SELECT * FROM blocks WHERE content LIKE '?' AND updated > '?' LIMIT ?" "%foo%" $today "3"}
```

## Invoke template

At the cursor caret position, select the template via `/` to trigger the template search, find the template that needs to be inserted and press Enter.

## An example

```cGxhaW50ZXh0
.action{$before := (div (now.Sub (toDate "2006-01-02" "2020-02-19")).Hours 24)}

.action{$after := (div ((toDate "2006-01-02" "2048-02-19").Sub now).Hours 24)}
Today is `.action{now | date "2006-01-02"}`.

* `.action{$before}` days have passed since `2020-02-19`
* There are `.action{$after}` days left from `2048-02-19`
```

`$before` and `$after` define two variables to record the number of days from the current date to 2020 and 2048, respectively.

## Push to template bazaar

Please make sure that the root path of your template repository contains at least the following files before listing ([repo example](https://github.com/88250/November-Rain)):

- template.json (please make sure the JSON format is correct)
- preview.png (please compress the image size within 512 KB)
- README.md (please note the case)

After confirmation, please [create a pull request](https://docs.github.com/en/free-pro-team@latest/github/collaborating-with-issues-and-pull-requests/creating-a-pull-request) to the [Community Bazaar](https://github.com/siyuan-note/bazaar) repository and modify the themes.json file in it. This file is the index file of all community template repositories, the format is:

```anNvbg==
{
   "repos": [
     "username/reponame@commithash"
   ]
}
```

Among them, `commithash`, please fill in the Git commit hash of the latest released version on your template repository, please use the full hash value instead of the 7-digit short value.

### Update

If the template you developed has an updated version, please remember:

- Update the version field in your template.json
- Create a Pull Request to the community bazaar
